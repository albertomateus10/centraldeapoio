<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Central de Apoio</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

  <style>
    :root {
      --bg: #f5f5f7;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --primary: #2563eb;
      --primary-2: #1d4ed8;
      --shadow: 0 10px 25px rgba(17, 24, 39, 0.08);
      --radius: 14px;

      /* ===== MODO COMPACTO ===== */
      --container-pad: 20px;
      --card-pad: 12px;
      --head-gap: 8px;
      --head-pad-bottom: 10px;
      --section-pad-top: 10px;
      --section-margin-top: 10px;
      --form-gap: 10px;
      --input-pad-y: 9px;
      --input-pad-x: 10px;
      --label-size: 12px;
      --input-size: 13px;
      --title-size: 14px;
      --helper-size: 11.5px;
      --btn-pad-y: 12px;
      --btn-pad-x: 16px;
      --btn-font: 14px;
      --actions-pad-top: 12px;
    }

    /* Toast Notification System */
    #toast-container {
      position: fixed;
      top: 30px;
      right: 30px;
      z-index: 99999;
      display: flex;
      flex-direction: column;
      gap: 12px;
      pointer-events: none;
    }

    .toast {
      pointer-events: auto;
      min-width: 320px;
      max-width: 450px;
      padding: 16px 24px;
      border-radius: 18px;
      background: rgba(255, 255, 255, 0.88);
      backdrop-filter: blur(15px) saturate(180%);
      -webkit-backdrop-filter: blur(15px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.05),
        0 10px 30px -5px rgba(0, 0, 0, 0.1),
        0 20px 40px -10px rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      gap: 16px;
      color: #1f2937;
      font-size: 14px;
      font-weight: 700;
      animation: toastSlideIn 0.5s cubic-bezier(0.19, 1, 0.22, 1);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }

    .toast:hover {
      transform: translateY(-2px);
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.05),
        0 15px 35px -5px rgba(0, 0, 0, 0.12),
        0 25px 45px -10px rgba(0, 0, 0, 0.08);
    }

    .toast i {
      font-size: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .toast.success {
      border-left: 6px solid #10b981;
    }

    .toast.success i {
      color: #10b981;
    }

    .toast.error {
      border-left: 6px solid #ef4444;
    }

    .toast.error i {
      color: #ef4444;
    }

    .toast.info {
      border-left: 6px solid #3b82f6;
    }

    .toast.info i {
      color: #3b82f6;
    }

    @keyframes toastSlideIn {
      from {
        transform: translateX(120%) scale(0.9);
        opacity: 0;
      }

      to {
        transform: translateX(0) scale(1);
        opacity: 1;
      }
    }

    @keyframes toastSlideOut {
      from {
        transform: translateX(0) scale(1);
        opacity: 1;
      }

      to {
        transform: translateX(120%) scale(0.9);
        opacity: 0;
      }
    }

    .toast-exiting {
      animation: toastSlideOut 0.4s cubic-bezier(0.4, 0, 1, 1) forwards;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px;
      background: radial-gradient(1200px 400px at 30% -10%, rgba(37, 99, 235, 0.12), transparent 50%),
        radial-gradient(900px 300px at 90% 10%, rgba(14, 165, 233, 0.10), transparent 55%),
        var(--bg);
      color: var(--text);
    }

    .container {
      background: var(--card);
      padding: var(--container-pad);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid rgba(229, 231, 235, 0.8);
    }

    h1 {
      text-align: center;
      margin: 20px auto 40px;
      width: fit-content;
      background: linear-gradient(145deg, #ffffff, #f8fafc);
      border: 2px solid #9ca3af;
      /* Cinza Médio Calmo */
      border-radius: 20px;
      padding: 12px 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.05),
        0 2px 4px -2px rgba(0, 0, 0, 0.05),
        inset 0 2px 4px rgba(255, 255, 255, 0.8);
      position: relative;
      overflow: hidden;

      /* Estilo de Texto */
      font-weight: 800;
      font-size: 18px;
      letter-spacing: 0.8px;
      text-transform: uppercase;
      color: #334155;
      line-height: 1.2;
    }

    .subtitle {
      text-align: center;
      color: rgba(107, 114, 128, 0.55);
      margin: 0 0 14px;
      font-size: 11px;
    }

    /* ===== CAPA ===== */
    .cover {
      background: linear-gradient(180deg, rgba(255, 255, 255, 1), rgba(249, 250, 251, 1));
      border: 2px solid #9ca3af;
      /* Cinza Médio Calmo */
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      margin-bottom: 12px;
      transition: all 0.3s ease;
    }

    .cover-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 10px;
    }

    /* Redesign da Navegação Principal (Botões) */
    .main-nav {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin: 20px 0 30px;
    }

    .nav-btn {
      background: linear-gradient(145deg, #ffffff, #f8fafc);
      border: 1px solid rgba(226, 232, 240, 0.8);
      border-radius: 20px;
      padding: 12px 12px;
      min-height: 60px;
      /* Garante tamanho uniforme */
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.05),
        0 2px 4px -2px rgba(0, 0, 0, 0.05),
        inset 0 2px 4px rgba(255, 255, 255, 0.8);
      position: relative;
      overflow: hidden;
    }

    .nav-btn span {
      font-weight: 800;
      font-size: 13px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      color: #334155;
      text-align: center;
      line-height: 1.2;
      transition: color 0.3s ease;
      z-index: 1;
    }

    .nav-btn small {
      color: #64748b;
      font-weight: 500;
      font-size: 13px !important;
      margin-top: 4px;
      opacity: 0.8;
      transition: color 0.3s ease;
    }

    .nav-btn:hover {
      transform: translateY(-4px);
      background: #ffffff;
      border-color: var(--primary);
      box-shadow:
        0 20px 25px -5px rgba(37, 99, 235, 0.1),
        0 8px 10px -6px rgba(37, 99, 235, 0.1);
    }

    .nav-btn.active {
      background: linear-gradient(135deg, #2563eb, #1e40af) !important;
      border-color: #1e40af !important;
      box-shadow:
        0 10px 20px -5px rgba(37, 99, 235, 0.4),
        inset 0 2px 4px rgba(255, 255, 255, 0.2);
    }

    .nav-btn.active span,
    .nav-btn.active small {
      color: #ffffff !important;
      opacity: 1;
    }

    /* Efeito de brilho sutil no hover */
    .nav-btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent);
      transition: 0.5s;
    }

    .nav-btn:hover::after {
      left: 100%;
    }

    .hidden {
      display: none !important;
    }

    @media (max-width: 768px) {
      .main-nav {
        grid-template-columns: 1fr;
      }
    }

    .cover-btn {
      width: 100%;
      min-height: 60px;
      border: 1px solid rgba(226, 232, 240, 0.8);
      border-radius: 18px;
      padding: 10px 14px;
      background: linear-gradient(145deg, #ffffff, #f8fafc);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.01);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
      overflow: hidden;
      position: relative;
    }

    .cover-btn:hover {
      transform: translateY(-3px);
      background: #ffffff;
      border-color: #3b82f6;
      box-shadow:
        0 20px 25px -5px rgba(59, 130, 246, 0.1),
        0 10px 10px -5px rgba(59, 130, 246, 0.04);
    }

    .cover-left {
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-width: 0;
      text-align: center;
      align-items: center;
      flex: 1 1 auto;
      width: 100%;
    }

    /* ===== NOME DO DOCUMENTO COM CARA DE BOTÃO (PILL PREMIUM) ===== */
    .cover-doc-pill {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 9px 16px;
      border-radius: 999px;
      font-weight: 800;
      font-size: 11px;
      letter-spacing: .4px;
      text-transform: uppercase;
      border: 1px solid rgba(30, 58, 138, 0.15);
      background: rgba(30, 58, 138, 0.04);
      color: #1e3a8a;
      box-shadow: 0 4px 6px -1px rgba(30, 58, 138, 0.05);
      line-height: 1.1;
      max-width: 100%;
      white-space: normal;
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .cover-hint {
      font-size: 11px;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-left: 4px;
    }

    .pill {
      flex: 0 0 auto;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      border: 1px solid;
      white-space: nowrap;
      letter-spacing: .2px;
      text-transform: uppercase;
    }

    /* cores dos pills */
    .pill-acordo {
      color: #166534;
      background: rgba(34, 197, 94, 0.12);
      border-color: rgba(34, 197, 94, 0.28);
    }

    .pill-receb {
      color: #075985;
      background: rgba(56, 189, 248, 0.14);
      border-color: rgba(56, 189, 248, 0.30);
    }

    .pill-quit {
      color: #111827;
      background: rgba(17, 24, 39, 0.10);
      border-color: rgba(17, 24, 39, 0.22);
    }

    .pill-inst {
      color: #4c1d95;
      background: rgba(139, 92, 246, 0.14);
      border-color: rgba(139, 92, 246, 0.30);
    }

    .pill-res {
      color: #92400e;
      background: rgba(251, 191, 36, 0.14);
      border-color: rgba(251, 191, 36, 0.30);
    }

    /* cores do nome-pílula na capa */
    .cover-doc-acordo {
      color: #166534;
      background: rgba(34, 197, 94, 0.10);
      border-color: rgba(34, 197, 94, 0.30);
    }

    .cover-doc-receb {
      color: #075985;
      background: rgba(56, 189, 248, 0.12);
      border-color: rgba(56, 189, 248, 0.32);
    }

    .cover-doc-quit {
      color: #111827;
      background: rgba(17, 24, 39, 0.08);
      border-color: rgba(17, 24, 39, 0.22);
    }

    .cover-doc-inst {
      color: #4c1d95;
      background: rgba(139, 92, 246, 0.12);
      border-color: rgba(139, 92, 246, 0.32);
    }

    .cover-doc-res {
      color: #92400e;
      background: rgba(251, 191, 36, 0.12);
      border-color: rgba(251, 191, 36, 0.32);
    }

    /* ===== TEXTO CONTRATUAL ===== */
    .pill-contrato {
      color: #075985;
      background: rgba(95, 168, 255, 0.14);
      border-color: rgba(95, 168, 255, 0.30);
    }

    .cover-doc-contrato {
      color: #075985;
      background: rgba(95, 168, 255, 0.12);
      border-color: rgba(95, 168, 255, 0.32);
    }

    .doc-title-contrato {
      color: #1d4e89;
      background: #ffffff;
      border-color: #1d4e89;
      box-shadow: 0 4px 12px rgba(29, 78, 137, 0.08);
    }

    /* ===== DEPÓSITO PARA TERCEIROS ===== */
    .pill-dep {
      color: #0f172a;
      background: rgba(148, 163, 184, 0.16);
      border-color: rgba(148, 163, 184, 0.35);
    }

    /* cores do nome-pílula na capa - ELEGÂNCIA PADRÃO */
    .cover-btn .cover-doc-pill {
      color: #1e3a8a;
      background: rgba(30, 58, 138, 0.05);
      border-color: rgba(30, 58, 138, 0.18);
    }

    .cover-btn:hover .cover-doc-pill {
      color: #1d4ed8;
      background: rgba(30, 58, 138, 0.08);
      border-color: rgba(30, 58, 138, 0.3);
      transform: scale(1.02);
    }

    /* Estado ATIVO do botão da capa */
    .cover-btn.active {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
      background: #eff6ff;
    }

    .cover-btn.active .cover-doc-pill {
      color: #fff;
      background: var(--primary);
      border-color: var(--primary);
      box-shadow: 0 4px 6px rgba(37, 99, 235, 0.3);
    }

    /* cores do título (mantidos nos cards internos) */
    .doc-title-dep {
      color: #0f172a;
      background: rgba(148, 163, 184, 0.14);
      border-color: rgba(148, 163, 184, 0.36);
    }

    /* cores do título */
    .doc-title-dep {
      color: #0f172a;
      background: rgba(148, 163, 184, 0.14);
      border-color: rgba(148, 163, 184, 0.36);
    }

    /* botão */
    .btn-deposito {
      background: linear-gradient(135deg, #334155, #64748b);
    }

    .doc-area {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .doc-card {
      background: linear-gradient(180deg, rgba(255, 255, 255, 1), rgba(249, 250, 251, 1));
      border: 2px solid #9ca3af;
      /* Cinza Médio Calmo */
      border-radius: 20px;
      padding: var(--card-pad);
      box-shadow: 0 8px 18px rgba(17, 24, 39, 0.06);
    }

    .doc-card .head {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: var(--head-gap);
      margin-bottom: 8px;
      padding-bottom: var(--head-pad-bottom);
      border-bottom: 1px dashed rgba(229, 231, 235, 0.9);
    }

    /* ===== TÍTULO NO ESTILO "BOTÃO" ===== */
    .doc-title-pill {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 9px 16px;
      border-radius: 999px;
      font-weight: 950;
      font-size: 14px;
      letter-spacing: .4px;
      border: 1px solid;
      text-transform: uppercase;
      user-select: none;
      box-shadow: 0 10px 18px rgba(17, 24, 39, 0.08);
      background: #fff;
    }

    .doc-title-acordo {
      color: #166534;
      background: rgba(34, 197, 94, 0.10);
      border-color: rgba(34, 197, 94, 0.30);
    }

    .doc-title-receb {
      color: #075985;
      background: rgba(56, 189, 248, 0.12);
      border-color: rgba(56, 189, 248, 0.32);
    }

    .doc-title-quit {
      color: #111827;
      background: rgba(17, 24, 39, 0.08);
      border-color: rgba(17, 24, 39, 0.22);
    }

    .doc-title-inst {
      color: #4c1d95;
      background: rgba(139, 92, 246, 0.12);
      border-color: rgba(139, 92, 246, 0.32);
    }

    .doc-title-res {
      color: #92400e;
      background: rgba(251, 191, 36, 0.12);
      border-color: rgba(251, 191, 36, 0.32);
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: var(--form-gap);
      margin-top: 8px;
    }

    .form-item {
      display: flex;
      flex-direction: column;
      gap: 5px;
      min-width: 0;
    }

    .form-item label {
      font-weight: 800;
      color: var(--primary-2);
      font-size: var(--label-size);
      line-height: 1.1;
    }

    .form-item input {
      text-transform: uppercase;
      padding: var(--input-pad-y) var(--input-pad-x);
      border: 1px solid rgba(209, 213, 219, 0.9);
      border-radius: 10px;
      font-size: var(--input-size);
      outline: none;
      background: rgba(255, 255, 255, 0.92);
      transition: border-color .2s, box-shadow .2s;
      height: 38px;
    }

    .form-item input::placeholder {
      color: #9ca3af;
    }

    .form-item input:focus {
      border-color: rgba(37, 99, 235, 0.65);
      box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.12);
    }

    .helper {
      font-size: var(--helper-size);
      color: var(--muted);
      margin: 8px 0 0;
      line-height: 1.25;
    }

    .section-title {
      margin-top: var(--section-margin-top);
      padding-top: var(--section-pad-top);
      border-top: 1px dashed rgba(229, 231, 235, 0.9);
      font-weight: 900;
      color: #111827;
      font-size: 12px;
      letter-spacing: .2px;
    }

    .doc-actions {
      margin-top: 12px;
      padding-top: var(--actions-pad-top);
      border-top: 1px dashed rgba(229, 231, 235, 0.9);
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      color: white;
      padding: var(--btn-pad-y) var(--btn-pad-x);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: var(--btn-font);
      transition: transform .15s ease, filter .15s ease, box-shadow .15s ease;
      font-weight: 900;
      box-shadow: 0 10px 18px rgba(17, 24, 39, 0.10);
      flex: 0 0 auto;
      min-width: 280px;
      max-width: 560px;
      width: auto;
      line-height: 1.1;
    }

    .btn:hover {
      transform: translateY(-1px);
      filter: brightness(1.02);
      box-shadow: 0 14px 22px rgba(17, 24, 39, 0.12);
    }

    .btn:active {
      transform: translateY(0px);
    }

    .btn-acordo {
      background: linear-gradient(135deg, #16a34a, #22c55e);
    }

    .btn-recebimento {
      background: linear-gradient(135deg, #0ea5e9, #38bdf8);
    }

    .btn-residencia {
      background: linear-gradient(135deg, #f59e0b, #fbbf24);
      color: #111827;
    }

    .btn-responsabilidade {
      background: linear-gradient(135deg, #6d28d9, #8b5cf6);
    }

    .btn-quitacao {
      background: linear-gradient(135deg, #111827, #374151);
    }

    .btn-contrato {
      background: linear-gradient(135deg, #5fa8ff, #38bdf8);
    }

    .hidden {
      display: none !important;
    }

    .footer {
      text-align: center;
      margin-top: 14px;
      padding: 8px 4px 0;
      color: rgba(107, 114, 128, 0.55);
      font-size: 13px;
    }

    @media (max-width: 520px) {
      body {
        padding: 12px;
      }

      h1 {
        font-size: 20px;
      }

      .container {
        padding: 16px;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .btn {
        flex: 1 1 100%;
      }

      .doc-title-pill {
        font-size: 14px;
        padding: 9px 14px;
      }

      .cover-doc-pill {
        font-size: 12.5px;
        padding: 9px 12px;
      }
    }

    /* ===== ESTILOS TEXTO CONTRATUAL ===== */
    .tabs-contrato {
      display: flex;
      gap: 14px;
      margin-bottom: 18px;
    }

    .tab-contrato {
      flex: 1;
      padding: 14px 20px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f7f9fd;
      font-weight: 700;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      transition: .18s ease;
      text-align: center;
    }

    .tab-contrato:hover {
      transform: translateY(-1px);
      border-color: rgba(95, 168, 255, 0.3);
    }

    .tab-contrato.active {
      background: rgba(95, 168, 255, 0.16);
      border-color: #5fa8ff;
      box-shadow: 0 0 0 4px rgba(95, 168, 255, 0.14);
    }

    .texto-contratual {
      width: 100%;
      min-height: 320px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: #ffffff;
      padding: 20px;
      font-family: "Times New Roman", Georgia, serif;
      font-size: 14px;
      line-height: 1.75;
      color: #111827;
      resize: vertical;
      outline: none;
    }

    .texto-contratual:focus {
      border-color: #5fa8ff;
      box-shadow: 0 0 0 4px rgba(95, 168, 255, 0.14);
    }

    /* ===== ESTILOS CALCULADORA DE JUROS ===== */
    .pill-calc {
      color: #0ea5e9;
      background: rgba(14, 165, 233, 0.14);
      border-color: rgba(14, 165, 233, 0.30);
    }

    .cover-doc-calc {
      color: #0ea5e9;
      background: rgba(14, 165, 233, 0.12);
      border-color: rgba(14, 165, 233, 0.32);
    }

    .doc-title-calc {
      color: #0ea5e9;
      background: rgba(14, 165, 233, 0.12);
      border-color: rgba(14, 165, 233, 0.32);
    }

    .btn-calc {
      background: linear-gradient(135deg, #0ea5e9, #38bdf8);
    }

    /* Calculadora - Campo de valor */
    .calc-input-grid {
      display: grid;
      grid-template-columns: 220px 1fr auto;
      gap: 10px;
      align-items: center;
      margin-bottom: 12px;
    }

    .calc-input-wrap {
      display: flex;
      align-items: center;
      gap: 8px;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(15, 23, 42, .02);
      min-height: 42px;
      transition: border-color .2s, box-shadow .2s;
    }

    .calc-input-wrap:focus-within {
      border-color: rgba(14, 165, 233, .50);
      box-shadow: 0 0 0 4px rgba(14, 165, 233, .16);
      background: rgba(14, 165, 233, .03);
    }

    .calc-prefix {
      font-weight: 900;
      font-size: 12px;
      color: rgba(15, 23, 42, .78);
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(229, 231, 235, 0.8);
      background: rgba(14, 165, 233, .10);
    }

    .calc-input {
      width: 100%;
      border: 0;
      outline: 0;
      background: transparent;
      font-size: 13px;
      font-weight: 700;
      color: var(--text);
      letter-spacing: .01em;
      caret-color: transparent;
    }

    .calc-input::placeholder {
      color: rgba(120, 130, 150, .75);
      font-weight: 600;
    }

    /* Botões dos bancos */
    .calc-bank-row {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .calc-bank-btn {
      appearance: none;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, .85);
      padding: 12px 20px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 12.5px;
      cursor: pointer;
      color: var(--text);
      transition: transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
      letter-spacing: .02em;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      user-select: none;
      box-shadow: 0 10px 18px rgba(17, 24, 39, 0.08);
      min-width: 180px;
      justify-content: center;
    }

    .calc-bank-btn:hover {
      background: rgba(14, 165, 233, .05);
      border-color: rgba(14, 165, 233, .28);
      transform: translateY(-1px);
    }

    .calc-bank-btn:active {
      transform: translateY(0px);
    }

    .calc-bank-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
    }

    .calc-bank-btn.banri .calc-bank-dot {
      background: linear-gradient(90deg, #06b6d4, #22c55e);
      box-shadow: 0 0 0 4px rgba(34, 197, 94, .10);
    }

    .calc-bank-btn.rede .calc-bank-dot {
      background: linear-gradient(90deg, #3b82f6, #1d4ed8);
      box-shadow: 0 0 0 4px rgba(59, 130, 246, .12);
    }

    .calc-bank-btn.active {
      border-color: rgba(14, 165, 233, .40);
      background: rgba(14, 165, 233, .10);
      box-shadow: 0 18px 40px rgba(14, 165, 233, .20);
      color: #0369a1;
    }

    .calc-bank-btn:not(.active) {
      opacity: 0.92;
      background: rgba(255, 255, 255, .72);
      color: rgba(15, 23, 42, .80);
    }

    /* Estado vazio */
    .calc-empty-state {
      border: 1px dashed rgba(15, 23, 42, .16);
      background: rgba(15, 23, 42, .02);
      border-radius: 14px;
      padding: 16px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45;
      font-weight: 650;
      text-align: center;
    }

    /* Tabela da calculadora */
    .calc-table-wrap {
      border-radius: 14px;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, .92);
      margin-bottom: 12px;
    }

    .calc-sheet {
      width: 100%;
      min-width: 760px;
      border-collapse: separate;
      border-spacing: 0;
      background: transparent;
    }

    .calc-sheet thead th {
      background: rgba(37, 99, 235, .08);
      border-bottom: 1px solid rgba(229, 231, 235, 0.8);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .08em;
      color: rgba(15, 23, 42, .76);
      padding: 10px 8px;
      text-align: center;
      font-weight: 900;
      white-space: nowrap;
    }

    .calc-sheet thead th.center {
      text-align: center;
    }

    .calc-sheet tbody td {
      padding: 10px 8px;
      font-size: 12.5px;
      border-bottom: 1px solid rgba(229, 231, 235, 0.6);
      background: transparent;
      vertical-align: middle;
      font-weight: 400;
      color: var(--text);
      white-space: nowrap;
    }

    .calc-sheet tbody tr:last-child td {
      border-bottom: 0;
    }

    /* Centralização das colunas da calculadora (mantém a 1ª coluna à esquerda) */
    .calc-sheet thead th,
    .calc-sheet tbody td {
      text-align: center;
    }

    .calc-sheet thead th:first-child,
    .calc-sheet tbody td:first-child {
      text-align: left;
    }


    .calc-sheet tbody tr:hover td {
      background: rgba(14, 165, 233, .04);
    }

    .calc-sheet .calc-muted {
      color: var(--muted);
      font-weight: 400;
    }

    .calc-sheet .calc-money {
      font-weight: 400;
      white-space: nowrap;
    }

    .calc-sheet th.calc-highlight {
      background: rgba(14, 165, 233, .14);
      font-size: 12px;
      color: #0369a1;
      font-weight: 900;
    }

    .calc-sheet td.calc-highlight {
      background: rgba(14, 165, 233, .10);
      font-weight: 700;
      font-size: 14px;
      color: #0369a1;
    }

    .calc-sheet th.calc-sep,
    .calc-sheet td.calc-sep {
      border-left: 2px solid rgba(14, 165, 233, .22);
    }

    .calc-hint-text {
      font-size: 11.5px;
      color: #94a3b8;
      margin-top: 10px;
      line-height: 1.45;
      font-weight: 600;
      text-align: center;
    }

    .calc-rotate-note {
      display: none;
      margin: 10px auto 0;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(15, 23, 42, .10);
      background: rgba(255, 255, 255, .75);
      color: rgba(15, 23, 42, .78);
      font-size: 12px;
      text-align: center;
    }

    @media (max-width: 760px) {
      .calc-input-grid {
        grid-template-columns: 1fr;
      }

      .calc-bank-btn {
        flex: 1;
        min-width: 0;
      }

      .calc-sheet {
        min-width: 840px;
      }
    }

    @media (max-width: 760px) and (orientation: portrait) {
      .calc-rotate-note {
        display: block;
      }
    }

    /* ===== ESTILOS ORÇAMENTO DETRAN (LUXURY) ===== */
    .orc-card {
      max-width: 950px;
      margin: 0 auto;
      background: #fff;
      padding: 1.5rem 2rem;
      border: 1px solid #000;
      border-radius: 4px;
      color: #000;
      font-family: 'Outfit', sans-serif;
    }

    .orc-header {
      text-align: center;
      margin-bottom: 1rem;
    }

    .orc-header h1 {
      font-size: 1.1rem;
      font-weight: 900;
      margin-bottom: 0.5rem;
      border-bottom: 2px solid #000;
      padding-bottom: 0.5rem;
    }

    .orc-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.35rem;
      margin-bottom: 0.5rem;
    }

    .orc-field {
      padding: 0.3rem 0.7rem;
      border: 1.5px solid #000;
      background: #fff;
    }

    .orc-label {
      display: block;
      font-size: 0.65rem;
      font-weight: 900;
      text-transform: uppercase;
      color: #444;
      margin-bottom: 2px;
    }

    .orc-input {
      width: 100%;
      font-size: 0.95rem;
      font-weight: 700;
      color: #000;
      border: none;
      background: transparent;
      outline: none;
      text-transform: uppercase;
    }

    .orc-input::placeholder {
      color: #94a3b8;
      font-style: italic;
      font-weight: 500;
    }

    .orc-table {
      width: 100%;
      border-collapse: collapse;
      margin: 0.6rem 0;
      font-size: 0.8rem;
    }

    .orc-table th {
      background: #f1f1f1;
      font-size: 0.7rem;
      font-weight: 900;
      text-transform: uppercase;
      border: 1px solid #000;
      padding: 0.4rem;
      text-align: left;
    }

    .orc-table td {
      padding: 0.35rem 0.7rem;
      border: 1px solid #000;
      font-weight: 700;
    }

    .orc-price:not([contenteditable="true"]) {
      font-style: italic;
    }

    .orc-total-box {
      margin-top: 0.4rem;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 0.8rem;
      padding: 0.4rem 1rem;
      background: #000;
      color: #fff;
    }

    .orc-total-amt {
      font-size: 1.3rem;
      font-weight: 900;
      color: #f59e0b;
    }

    .orc-legal {
      margin-top: 0.6rem;
      padding: 0.6rem;
      border: 1px solid #000;
      font-size: 0.6rem;
      font-weight: 600;
      text-align: justify;
      text-transform: uppercase;
      line-height: 1.2;
    }

    .orc-sigs {
      margin-top: 5rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2.5rem;
      text-align: center;
    }

    .orc-sig-line {
      border-top: 2px solid #000;
      padding-top: 4px;
      font-size: 0.7rem;
      font-weight: 900;
      text-transform: uppercase;
    }

    .obs-placeholder:empty:before {
      content: attr(placeholder);
      color: #94a3b8;
      font-style: italic;
      font-weight: 500;
    }

    @media print {
      body {
        background: white !important;
        padding: 0 !important;
        margin: 0 !important;
      }

      /* Hide all UI elements */
      .container>h1,
      .subtitle,
      .main-nav,
      .nav-btn,
      .cover,
      .head,
      .footer,
      .doc-actions,
      #dados-cliente-global,
      .section-title {
        display: none !important;
      }

      .container {
        box-shadow: none !important;
        border: none !important;
        padding: 0 !important;
        margin: 0 !important;
      }

      .doc-card {
        border: none !important;
        box-shadow: none !important;
        padding: 0 !important;
        margin: 0 !important;
      }

      /* Reduce budget card size to fit on one page */
      .orc-card {
        max-width: 100%;
        margin: 0;
        padding: 0.8rem 1.2rem !important;
        border: 1px solid #000 !important;
        transform: scale(0.95);
        transform-origin: top center;
      }

      .orc-header {
        margin-bottom: 0.5rem !important;
      }

      .orc-header h1 {
        font-size: 0.95rem !important;
        margin-bottom: 0.3rem !important;
        padding-bottom: 0.3rem !important;
      }

      .orc-grid {
        gap: 0.25rem !important;
        margin-bottom: 0.3rem !important;
      }

      .orc-field {
        padding: 0.2rem 0.5rem !important;
      }

      .orc-label {
        font-size: 0.55rem !important;
        margin-bottom: 1px !important;
      }

      .orc-input {
        font-size: 0.8rem !important;
      }

      .orc-table {
        margin: 0.4rem 0 !important;
        font-size: 0.7rem !important;
      }

      .orc-table th {
        font-size: 0.6rem !important;
        padding: 0.25rem !important;
      }

      .orc-table td {
        padding: 0.25rem 0.5rem !important;
      }

      .orc-total-box {
        background: transparent !important;
        color: #000 !important;
        border: 1px solid #000;
        margin-top: 0.3rem !important;
        padding: 0.3rem 0.8rem !important;
      }

      .orc-total-amt {
        color: #000 !important;
        font-size: 1.1rem !important;
      }

      .orc-legal {
        margin-top: 0.4rem !important;
        padding: 0.4rem !important;
        font-size: 0.52rem !important;
        line-height: 1.15 !important;
      }

      .orc-sigs {
        margin-top: 2.5rem !important;
        gap: 1.5rem !important;
      }

      .orc-sig-line {
        font-size: 0.6rem !important;
        padding-top: 3px !important;
      }

      @page {
        margin: 0.5cm;
        size: a4;
      }
    }

    /* ===== ESTILOS LINKS ÚTEIS (CORES ELEGANTES) ===== */
    .link-section-estoques .section-title {
      color: #1e3a8a !important;
    }

    .link-section-estoques .cover-doc-pill {
      color: #1e3a8a !important;
      border-color: rgba(30, 58, 138, 0.25) !important;
    }

    .link-section-estoques .cover-btn:hover {
      background: rgba(30, 58, 138, 0.04) !important;
      border-color: #1e3a8a !important;
    }

    .link-section-consultas .section-title {
      color: #065f46 !important;
    }

    .link-section-consultas .cover-doc-pill {
      color: #065f46 !important;
      border-color: rgba(6, 95, 70, 0.25) !important;
    }

    .link-section-consultas .cover-btn:hover {
      background: rgba(6, 95, 70, 0.04) !important;
      border-color: #065f46 !important;
    }

    .link-section-plataformas .section-title {
      color: #3730a3 !important;
    }

    .link-section-plataformas .cover-doc-pill {
      color: #3730a3 !important;
      border-color: rgba(55, 48, 163, 0.25) !important;
    }

    .link-section-plataformas .cover-btn:hover {
      background: rgba(55, 48, 163, 0.04) !important;
      border-color: #3730a3 !important;
    }

    .link-section-ferramentas .section-title {
      color: #9a3412 !important;
    }

    .link-section-ferramentas .cover-doc-pill {
      color: #9a3412 !important;
      border-color: rgba(154, 52, 18, 0.25) !important;
    }

    .link-section-ferramentas .cover-btn:hover {
      background: rgba(154, 52, 18, 0.04) !important;
      border-color: #9a3412 !important;
    }

    .link-section-gestor .section-title {
      color: #581c87 !important;
    }

    .link-section-gestor .cover-doc-pill {
      color: #581c87 !important;
      border-color: rgba(88, 28, 135, 0.25) !important;
    }

    .link-section-gestor .cover-btn:hover {
      background: rgba(88, 28, 135, 0.04) !important;
      border-color: #581c87 !important;
    }

    .link-section-certidoes .section-title {
      color: #0d9488 !important;
    }

    .link-section-certidoes .cover-doc-pill {
      color: #0d9488 !important;
      border-color: rgba(13, 148, 136, 0.25) !important;
    }

    .link-section-certidoes .cover-btn:hover {
      background: rgba(13, 148, 136, 0.04) !important;
      border-color: #0d9488 !important;
    }

    .link-section-venda-direta .section-title {
      color: #1e40af !important;
    }

    .link-section-venda-direta .cover-doc-pill {
      color: #1e40af !important;
      border-color: rgba(30, 64, 175, 0.25) !important;
    }

    .link-section-venda-direta .cover-btn:hover {
      background: rgba(30, 64, 175, 0.04) !important;
      border-color: #1e40af !important;
    }

    .link-section-bancos .section-title {
      color: #334155 !important;
    }

    .link-section-bancos .cover-doc-pill {
      color: #334155 !important;
      border-color: rgba(51, 65, 85, 0.25) !important;
    }

    .link-section-bancos .cover-btn:hover {
      background: rgba(51, 65, 85, 0.04) !important;
      border-color: #334155 !important;
    }

    .link-section-cartas .section-title {
      color: #7c2d12 !important;
    }

    .link-section-cartas .cover-doc-pill {
      color: #7c2d12 !important;
      border-color: rgba(124, 45, 18, 0.25) !important;
    }

    .link-section-cartas .cover-btn:hover {
      background: rgba(124, 45, 18, 0.04) !important;
      border-color: #7c2d12 !important;
    }

    /* Estilo de Card para as seções de Links Úteis */
    .link-section {
      background: #ffffff;
      border: 2px solid #9ca3af;
      /* Cinza Médio Calmo */
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 25px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
  <div class="container">
    <h1>Central de Apoio</h1>

    <div id="toast-container"></div>

    <!-- =========================
         CAPA (apenas nomes dos documentos)
         ========================= -->
    <!-- Navegação Principal -->
    <div class="main-nav">
      <button class="nav-btn" id="btn-gerador" onclick="alternarSecao('gerador')">
        <span>GERADOR DE DOCUMENTOS</span>
      </button>
      <button class="nav-btn" id="btn-calculadora" onclick="alternarSecao('calculadora')">
        <span>CALCULADORA<br><small
            style="font-style: italic; font-size: 13px; text-transform: lowercase !important; font-weight: normal;">(juros
            do cartão de crédito)</small></span>
      </button>
      <button class="nav-btn" id="btn-bancos" onclick="alternarSecao('bancos')">
        <span>BANCOS</span>
      </button>
      <button class="nav-btn" id="btn-certidoes" onclick="alternarSecao('certidoes')">
        <span>CERTIDÕES</span>
      </button>
      <button class="nav-btn" id="btn-venda-direta" onclick="alternarSecao('venda-direta')">
        <span>VENDA DIRETA</span>
      </button>
      <button class="nav-btn" id="btn-plataformas" onclick="alternarSecao('plataformas')">
        <span>PLATAFORMAS e SISTEMAS</span>
      </button>
      <button class="nav-btn" id="btn-cartas" onclick="alternarSecao('cartas')">
        <span>MONTADORA<br><small
            style="font-style: italic; font-size: 13px; text-transform: lowercase !important; font-weight: normal;">(gama
            e cartas do mês)</small></span>
      </button>
      <button class="nav-btn" id="btn-seminovos" onclick="alternarSecao('seminovos')">
        <span>SEMINOVOS</span>
      </button>
      <button class="nav-btn" id="btn-gestor" onclick="alternarSecao('gestor')">
        <span>APOIO AO GESTOR</span>
      </button>
      <button class="nav-btn" id="btn-pos-vendas" onclick="alternarSecao('pos-vendas')">
        <span>PÓS VENDAS</span>
      </button>
      <button class="nav-btn" id="btn-lojas" onclick="alternarSecao('lojas')">
        <span>LOCALIZAÇÃO DAS LOJAS</span>
      </button>
      <button class="nav-btn" id="btn-links" onclick="alternarSecao('links')">
        <span>LINKS ÚTEIS</span>
      </button>
    </div>

    <!-- Seção: Gerador de Documentos (Submenu) -->
    <div class="cover hidden" id="secao-gerador">
      <div class="cover-grid">
        <button class="cover-btn" id="btn-doc-recebimento" type="button" onclick="abrirDocumento('doc-recebimento')">
          <div class="cover-doc-pill">PROCURAÇÃO DE RECEBIMENTO DO USADO</div>
        </button>

        <button class="cover-btn" id="btn-doc-acordo" type="button" onclick="abrirDocumento('doc-acordo')">
          <div class="cover-doc-pill">PROCURAÇÃO DE ACORDO</div>
        </button>

        <button class="cover-btn" id="btn-doc-instrumento" type="button" onclick="abrirDocumento('doc-instrumento')">
          <div class="cover-doc-pill">INSTRUMENTO DE RESPONSABILIDADE</div>
        </button>

        <button class="cover-btn" id="btn-doc-quitacao" type="button" onclick="abrirDocumento('doc-quitacao')">
          <div class="cover-doc-pill">TERMO DE QUITAÇÃO (veículo de terceiros)</div>
        </button>

        <button class="cover-btn" id="btn-doc-residencia" type="button" onclick="abrirDocumento('doc-residencia')">
          <div class="cover-doc-pill">DECLARAÇÃO DE RESIDÊNCIA</div>
        </button>

        <button class="cover-btn" id="btn-doc-deposito" type="button" onclick="abrirDocumento('doc-deposito')">
          <div class="cover-doc-pill">DECLARAÇÃO DE DEPÓSITO PARA TERCEIROS</div>
        </button>

        <button class="cover-btn" id="btn-doc-orcamento" type="button" onclick="abrirDocumento('doc-orcamento')">
          <div class="cover-doc-pill">ORÇAMENTO DE DETRAN</div>
        </button>
      </div>
    </div>

    <!-- Seção: Bancos (Submenu) -->
    <div class="cover hidden" id="secao-bancos" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="https://autofacil.stellantisfinanciamentos.com.br/login" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">PSA (Stellantis)</div>
        </a>
        <a href="https://digital.bancovw.com.br/FrontEnd/login" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">VOLKS</div>
        </a>
        <a href="https://www.credlineitau.com.br/" target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">ITAÚ CREDLINE</div>
        </a>
        <a href="https://financiamentos.bradesco/financiamentos/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BRADESCO</div>
        </a>
        <a href="https://financeira.safra.com.br/portal-veiculos/login" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">SAFRA</div>
        </a>
        <a href="https://c6auto.com.br/originacaolojista/login" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">C6 AUTO</div>
        </a>
        <a href="https://parceiro.bv.com.br/ng-gpar-base-login/#" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BV FINANCEIRA</div>
        </a>
        <a href="https://veiculos.bancopan.com.br/login" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BANCO PAN</div>
        </a>
      </div>
    </div>

    <!-- Seção: Certidões (Submenu) -->
    <div class="cover hidden" id="secao-certidoes" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="https://www2.trf4.jus.br/trf4/processos/certidao/index.php?string_cpf=01525186060" target="_blank"
          class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">CERTIDÃO JUDICIAL</div>
        </a>
        <a href="https://www.tst.jus.br/certidao1" target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">CERTIDÃO TRABALHISTA</div>
        </a>
        <a href="https://www.tjrs.jus.br/novo/processos-e-servicos/servicos-processuais/emissao-de-antecedentes-e-certidoes/"
          target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">ANTECEDENTES TJRS</div>
        </a>
        <a href="https://pje.trt4.jus.br/certidoes/inicio" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">CERTIDÕES TRT4</div>
        </a>
      </div>
    </div>

    <!-- Seção: Venda Direta (Submenu) -->
    <div class="cover hidden" id="secao-venda-direta" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="https://solucoes.receita.fazenda.gov.br/servicos/cnpjreva/cnpjreva_solicitacao.asp" target="_blank"
          class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">CARTÃO CNPJ</div>
        </a>
        <a href="https://www.sefaz.rs.gov.br/consultas/contribuinte" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">INSCRIÇÃO ESTADUAL</div>
        </a>
        <a href="https://dfe-portal.svrs.rs.gov.br/cte/ccc?origem=2" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">IE PRODUTOR RURAL</div>
        </a>
        <a href="https://ws.bndes.gov.br/cfi_catalogo/produto/04281040" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BNDES FIORINO</div>
        </a>
        <a href="https://ws.bndes.gov.br/cfi_catalogo/produto/04260579" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BNDES STRADA FREEDOM</div>
        </a>
        <a href="https://ws.bndes.gov.br/cfi_catalogo/produto/04263917" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BNDES STRADA ENDURANCE</div>
        </a>
      </div>
    </div>

    <!-- Seção: Plataformas (Submenu) -->
    <div class="cover hidden" id="secao-plataformas" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="http://152.67.47.29:8080/crmgold/veiculo.zul" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">NBS GOLD</div>
        </a>
        <a href="https://apps.docusign.com/send/home" target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">DOCUSIGN</div>
        </a>
        <a href="https://apps.autoavaliar.com.br/login/app" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">AUTOAVALIAR</div>
        </a>
        <a href="https://app.dugestao.com.br/#/home" target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">DUGESTÃO</div>
        </a>
        <a href="https://app.duleads.com.br/#/auth" target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">DULEADS</div>
        </a>
        <a href="https://psa.csod.com/login/render.aspx?id=stellantistraining" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">PORTAL DE TREINAMENTOS FIAT</div>
        </a>
      </div>
    </div>

    <!-- Seção: Cartas do Mês (Submenu) -->
    <div class="cover hidden" id="secao-cartas" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="https://albertomateus10.github.io/pdfsdomes/cartafiat.pdf" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">CARTA DO MÊS (Montadora)</div>
        </a>
        <a href="https://albertomateus10.github.io/pdfsdomes/cartabanco.pdf" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">CARTA DO MÊS (Banco)</div>
        </a>
        <a href="https://albertomateus10.github.io/pdfsdomes/gama.pdf" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">GAMA ATUALIZADA</div>
        </a>
      </div>
    </div>

    <!-- Seção: Seminovos (Submenu) -->
    <div class="cover hidden" id="secao-seminovos" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="https://sanmarinomultimarcas.com.br/seminovos/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">ESTOQUE DE SEMINOVOS</div>
        </a>
        <a href="https://sanmarinomultimarcas.com.br/outlet/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">ESTOQUE OUTLET</div>
        </a>
        <a href="https://albertomateus10.github.io/termoderepassefuncionario/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">TERMO DE REPASSE PARA FUNCIONÁRIO</div>
        </a>
        <button class="cover-btn" type="button" onclick="abrirDocumento('doc-contrato')">
          <div class="cover-doc-pill">TEXTO LEGAL (Seminovos/Outlet)</div>
        </button>
        <a href="https://albertomateus10.github.io/preparacaoparaentrega/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">CHECKLIST de ENTREGA (Seminovo)</div>
        </a>
        <a href="https://chatgpt.com/g/g-67b0af6b29708191982adcba7a5e3fb4-clique-aqui-e-crie-um-anuncio-para-o-seu-veiculo"
          target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">ROBÔ DE ANÚNCIOS</div>
        </a>
      </div>
    </div>

    <!-- Seção: Gestor (Submenu) -->
    <div class="cover hidden" id="secao-gestor" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <a href="http://144.22.144.53/" target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">NBS SHOTCUT</div>
        </a>
        <a href="https://portal.gestautobrasil.com.br/auth/login" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">PORTAL GESTAUTO</div>
        </a>
        <a href="https://app.autocorp.com.br/portal/Default.aspx?ReturnUrl=%2frestrito%2fpainel-controle%2fdefault.aspx"
          target="_blank" class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">AUTOCORP</div>
        </a>
        <a href="https://albertomateus10.github.io/avaliacoes/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">BI DE AVALIAÇÕES</div>
        </a>
        <a href="https://albertomateus10.github.io/carteiravdusados/" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">USADOS VIA VD</div>
        </a>
        <a href="https://adm.autoavaliar.com.br/index.php" target="_blank" class="cover-btn"
          style="text-decoration: none;">
          <div class="cover-doc-pill">Leilão do AutoAvaliar</div>
        </a>
      </div>
    </div>

    <!-- Seção: Pós Vendas (Submenu) -->
    <div class="cover hidden" id="secao-pos-vendas" style="margin-top: 20px;">
      <div class="cover-grid" style="max-width: 900px; margin: 0 auto;">
        <button class="cover-btn" type="button">
          <div class="cover-doc-pill">CATÁLOGO DE ACESSÓRIOS</div>
        </button>

        <a href="https://drive.google.com/drive/folders/1pVktoHOniUgT5LQfnjxWhDGAB1r3-LVn" target="_blank"
          class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">NORMAS DA GARANTIA</div>
        </a>
        <a href="https://drive.google.com/drive/folders/1dn-1v52zMjZCnBZRgHCkAdViAOBfOG2b" target="_blank"
          class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">APOIO AO CONSULTOR</div>
        </a>
        <a href="https://drive.google.com/drive/folders/1alytD0dOACelokORixMLNd99Ixe77han" target="_blank"
          class="cover-btn" style="text-decoration: none;">
          <div class="cover-doc-pill">APOIO AO MECÂNICO</div>
        </a>
      </div>
    </div>

    <!-- Seção: Localização das Lojas (Submenu) -->
    <div class="cover hidden" id="secao-lojas" style="margin-top: 15px;">
      <div style="max-width: 700px; margin: 0 auto;">

        <!-- MATRIZ -->
        <div class="link-section" style="padding: 12px; margin-bottom: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <a href="matriz.jpeg" target="_blank" title="Clique para abrir e baixar"
              style="width: 60px; height: 60px; border-radius: 10px; overflow: hidden; border: 2px solid #e2e8f0; display: flex; align-items: center; justify-content: center; flex-shrink: 0; cursor: pointer;">
              <img src="matriz.jpeg" alt="San Marino Matriz" style="width: 100%; height: 100%; object-fit: cover;">
            </a>
            <div>
              <div style="font-weight: 900; color: #1e3a8a; font-size: 14px;">MATRIZ</div>
              <div style="font-size: 11px; color: var(--muted);">Av. Ipiranga, 7110 - Porto Alegre</div>
            </div>
          </div>
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <a href="https://maps.app.goo.gl/9JXa77im6c8KK72w6" target="_blank" class="btn"
              style="flex: 1; min-width: 150px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; text-decoration: none; font-size: 12px;">
              <i class="fa-solid fa-map-location-dot"></i>&nbsp; Ver no Mapa
            </a>
            <button class="btn"
              style="flex: 2; min-width: 200px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; font-size: 11px;"
              onclick="copiarLink('https://maps.app.goo.gl/9JXa77im6c8KK72w6')">
              <i class="fa-regular fa-copy"></i>&nbsp; copie o link e cole no whats do cliente
            </button>
          </div>
        </div>

        <!-- ZONA SUL -->
        <div class="link-section" style="padding: 12px; margin-bottom: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <a href="zonasul.jpeg" target="_blank" title="Clique para abrir e baixar"
              style="width: 60px; height: 60px; border-radius: 10px; overflow: hidden; border: 2px solid #e2e8f0; display: flex; align-items: center; justify-content: center; flex-shrink: 0; cursor: pointer;">
              <img src="zonasul.jpeg" alt="San Marino Zona Sul" style="width: 100%; height: 100%; object-fit: cover;">
            </a>
            <div>
              <div style="font-weight: 900; color: #1e3a8a; font-size: 14px;">ZONA SUL</div>
              <div style="font-size: 11px; color: var(--muted);">Av. Otto Niemeyer, 650 - Bairro Tristeza, Porto Alegre
              </div>
            </div>
          </div>
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <a href="https://maps.app.goo.gl/6JWn6nwzN2zYsqpE7" target="_blank" class="btn"
              style="flex: 1; min-width: 150px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; text-decoration: none; font-size: 12px;">
              <i class="fa-solid fa-map-location-dot"></i>&nbsp; Ver no Mapa
            </a>
            <button class="btn"
              style="flex: 2; min-width: 200px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; font-size: 11px;"
              onclick="copiarLink('https://maps.app.goo.gl/6JWn6nwzN2zYsqpE7')">
              <i class="fa-regular fa-copy"></i>&nbsp; copie o link e cole no whats do cliente
            </button>
          </div>
        </div>

        <!-- GRAVATAÍ -->
        <div class="link-section" style="padding: 12px; margin-bottom: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <a href="gravatai.jpeg" target="_blank" title="Clique para abrir e baixar"
              style="width: 60px; height: 60px; border-radius: 10px; overflow: hidden; border: 2px solid #e2e8f0; display: flex; align-items: center; justify-content: center; flex-shrink: 0; cursor: pointer;">
              <img src="gravatai.jpeg" alt="San Marino Gravataí" style="width: 100%; height: 100%; object-fit: cover;">
            </a>
            <div>
              <div style="font-weight: 900; color: #1e3a8a; font-size: 14px;">GRAVATAÍ</div>
              <div style="font-size: 11px; color: var(--muted);">Pda. 61, RS-020, 280 - Bairro Vera Cruz, Gravataí
              </div>
            </div>
          </div>
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <a href="https://maps.app.goo.gl/eyiSQ1vSy2q2MJpa8" target="_blank" class="btn"
              style="flex: 1; min-width: 150px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; text-decoration: none; font-size: 12px;">
              <i class="fa-solid fa-map-location-dot"></i>&nbsp; Ver no Mapa
            </a>
            <button class="btn"
              style="flex: 2; min-width: 200px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; font-size: 11px;"
              onclick="copiarLink('https://maps.app.goo.gl/eyiSQ1vSy2q2MJpa8')">
              <i class="fa-regular fa-copy"></i>&nbsp; copie o link e cole no whats do cliente
            </button>
          </div>
        </div>

        <!-- MULTIMARCAS -->
        <div class="link-section" style="padding: 12px; margin-bottom: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <a href="Multimarcas.jpeg" target="_blank" title="Clique para abrir e baixar"
              style="width: 60px; height: 60px; border-radius: 10px; overflow: hidden; border: 2px solid #e2e8f0; display: flex; align-items: center; justify-content: center; flex-shrink: 0; cursor: pointer;">
              <img src="Multimarcas.jpeg" alt="San Marino Multimarcas"
                style="width: 100%; height: 100%; object-fit: cover;">
            </a>
            <div>
              <div style="font-weight: 900; color: #1e3a8a; font-size: 14px;">MULTIMARCAS</div>
              <div style="font-size: 11px; color: var(--muted);">Pda. 61, RS-020, 220 - Bairro Vera Cruz, Gravataí
              </div>
            </div>
          </div>
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <a href="https://maps.app.goo.gl/Gs2jGm9dMUxUEFjv9" target="_blank" class="btn"
              style="flex: 1; min-width: 150px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; text-decoration: none; font-size: 12px;">
              <i class="fa-solid fa-map-location-dot"></i>&nbsp; Ver no Mapa
            </a>
            <button class="btn"
              style="flex: 2; min-width: 200px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; font-size: 11px;"
              onclick="copiarLink('https://maps.app.goo.gl/Gs2jGm9dMUxUEFjv9')">
              <i class="fa-regular fa-copy"></i>&nbsp; copie o link e cole no whats do cliente
            </button>
          </div>
        </div>

        <!-- VIAMÃO -->
        <div class="link-section" style="padding: 12px; margin-bottom: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <a href="Viamão.jpeg" target="_blank" title="Clique para abrir e baixar"
              style="width: 60px; height: 60px; border-radius: 10px; overflow: hidden; border: 2px solid #e2e8f0; display: flex; align-items: center; justify-content: center; flex-shrink: 0; cursor: pointer;">
              <img src="Viamão.jpeg" alt="San Marino Viamão" style="width: 100%; height: 100%; object-fit: cover;">
            </a>
            <div>
              <div style="font-weight: 900; color: #1e3a8a; font-size: 14px;">VIAMÃO</div>
              <div style="font-size: 11px; color: var(--muted);">Av. Sen. Salgado Filho, 9775 - Bairro Jardim Krahe,
                Viamão</div>
            </div>
          </div>
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <a href="https://maps.app.goo.gl/6Rpe55NcW35yD6dCA" target="_blank" class="btn"
              style="flex: 1; min-width: 150px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; text-decoration: none; font-size: 12px;">
              <i class="fa-solid fa-map-location-dot"></i>&nbsp; Ver no Mapa
            </a>
            <button class="btn"
              style="flex: 2; min-width: 200px; height: 38px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; color: #1e3a8a; box-shadow: none; border: 1px solid #e2e8f0; font-size: 11px;"
              onclick="copiarLink('https://maps.app.goo.gl/6Rpe55NcW35yD6dCA')">
              <i class="fa-regular fa-copy"></i>&nbsp; copie o link e cole no whats do cliente
            </button>
          </div>
        </div>

      </div>
    </div>

    <!-- =========================
         ÁREA DOS DOCUMENTOS (ocultos até clicar)
         ========================= -->

    <!-- =========================
         DADOS GLOBAIS DO CLIENTE
         ========================= -->
    <div class="cover hidden" id="dados-cliente-global" style="margin-top: 20px;">
      <div class="section-title"
        style="border-top: none; margin-top: 0; padding-top: 0; font-size: 16px; margin-bottom: 15px;">
        👤 DADOS DO CLIENTE (Preencha uma vez para todos os documentos)
      </div>
      <div class="form-grid">
        <div class="form-item">
          <label for="global_nomeCompleto">Nome Completo</label>
          <input type="text" id="global_nomeCompleto" placeholder="Nome completo do cliente"
            oninput="replicarDadosCliente()">
        </div>
        <div class="form-item">
          <label for="global_cpfCnpj">CPF/CNPJ</label>
          <input type="text" id="global_cpfCnpj" placeholder="000.000.000-00" oninput="replicarDadosCliente()">
        </div>
        <div class="form-item">
          <label for="global_endereco">Endereço</label>
          <input type="text" id="global_endereco" placeholder="Rua/av, número, complemento"
            oninput="replicarDadosCliente()">
        </div>
        <div class="form-item">
          <label for="global_bairro">Bairro</label>
          <input type="text" id="global_bairro" placeholder="Nome do bairro" oninput="replicarDadosCliente()">
        </div>
        <div class="form-item">
          <label for="global_cep">CEP</label>
          <input type="text" id="global_cep" placeholder="00000-000" oninput="replicarDadosCliente()">
        </div>
        <div class="form-item">
          <label for="global_cidade">Cidade</label>
          <input type="text" id="global_cidade" placeholder="Nome da cidade" oninput="replicarDadosCliente()">
        </div>
        <div class="form-item">
          <label for="global_estado">Estado</label>
          <input type="text" id="global_estado" placeholder="Sigla do Estado" oninput="replicarDadosCliente()">
        </div>
      </div>
    </div>

    <div class="doc-area" id="docArea">

      <!-- =========================
           1) PROCURAÇÃO DE ACORDO
           ========================= -->
      <div class="doc-card hidden" id="doc-acordo">
        <div class="head">
          <div class="doc-title-pill doc-title-acordo">PROCURAÇÃO DE ACORDO</div>
        </div>

        <div class="section-title">Dados do Cliente</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="acordo_nomeCompleto">Nome Completo</label>
            <input type="text" id="acordo_nomeCompleto" placeholder="Nome completo do cliente">
          </div>
          <div class="form-item">
            <label for="acordo_cpfCnpj">CPF/CNPJ</label>
            <input type="text" id="acordo_cpfCnpj" placeholder="000.000.000-00">
          </div>
          <div class="form-item">
            <label for="acordo_endereco">Endereço</label>
            <input type="text" id="acordo_endereco" placeholder="Rua/av, número, complemento">
          </div>
          <div class="form-item">
            <label for="acordo_bairro">Bairro</label>
            <input type="text" id="acordo_bairro" placeholder="Nome do bairro">
          </div>
          <div class="form-item">
            <label for="acordo_cep">CEP</label>
            <input type="text" id="acordo_cep" placeholder="00000-000">
          </div>
          <div class="form-item">
            <label for="acordo_cidade">Cidade</label>
            <input type="text" id="acordo_cidade" placeholder="Nome da cidade">
          </div>
          <div class="form-item">
            <label for="acordo_estado">Estado</label>
            <input type="text" id="acordo_estado" placeholder="Sigla do Estado">
          </div>
        </div>

        <div class="section-title">Dados do Veículo</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="acordo_modelo">Modelo do Veículo</label>
            <input type="text" id="acordo_modelo" placeholder="Ex: CHEVROLET/ONIX 1.0 TURBO">
          </div>
          <div class="form-item">
            <label for="acordo_placa">Placa</label>
            <input type="text" id="acordo_placa" placeholder="ABC1D23">
          </div>
          <div class="form-item">
            <label for="acordo_anoModelo">Ano/Modelo</label>
            <input type="text" id="acordo_anoModelo" placeholder="2020/2021">
          </div>
          <div class="form-item">
            <label for="acordo_chassi">Chassi</label>
            <input type="text" id="acordo_chassi" placeholder="17 caracteres">
          </div>
          <div class="form-item">
            <label for="acordo_renavam">Renavam</label>
            <input type="text" id="acordo_renavam" placeholder="11 caracteres">
          </div>
          <div class="form-item">
            <label for="acordo_cor">Cor</label>
            <input type="text" id="acordo_cor" placeholder="Cor do veículo">
          </div>
        </div>

        <div class="doc-actions">
          <button class="btn btn-acordo" type="button" onclick="gerarProcuracaoAcordo()"> Gerar
            Procuração de
            Acordo</button>
        </div>
      </div>

      <!-- =========================
           2) PROCURAÇÃO DE RECEBIMENTO
           ========================= -->
      <div class="doc-card hidden" id="doc-recebimento">
        <div class="head">
          <div class="doc-title-pill doc-title-receb">PROCURAÇÃO DE RECEBIMENTO DO USADO</div>
        </div>

        <div class="section-title">Dados do Cliente</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="rec_nomeCompleto">Nome Completo</label>
            <input type="text" id="rec_nomeCompleto" placeholder="Nome completo do cliente">
          </div>
          <div class="form-item">
            <label for="rec_cpfCnpj">CPF/CNPJ</label>
            <input type="text" id="rec_cpfCnpj" placeholder="000.000.000-00">
          </div>
          <div class="form-item">
            <label for="rec_endereco">Endereço</label>
            <input type="text" id="rec_endereco" placeholder="Rua/av, número, complemento">
          </div>
          <div class="form-item">
            <label for="rec_bairro">Bairro</label>
            <input type="text" id="rec_bairro" placeholder="Nome do bairro">
          </div>
          <div class="form-item">
            <label for="rec_cidade">Cidade</label>
            <input type="text" id="rec_cidade" placeholder="Nome da cidade">
          </div>
          <div class="form-item">
            <label for="rec_estado">Estado</label>
            <input type="text" id="rec_estado" placeholder="Sigla do Estado">
          </div>
        </div>

        <div class="section-title">Dados do Veículo</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="rec_modelo">Modelo do Veículo</label>
            <input type="text" id="rec_modelo" placeholder="Ex: CHEVROLET/ONIX 1.0 TURBO">
          </div>
          <div class="form-item">
            <label for="rec_placa">Placa</label>
            <input type="text" id="rec_placa" placeholder="ABC1D23">
          </div>
          <div class="form-item">
            <label for="rec_anoModelo">Ano/Modelo</label>
            <input type="text" id="rec_anoModelo" placeholder="2020/2021">
          </div>
          <div class="form-item">
            <label for="rec_chassi">Chassi</label>
            <input type="text" id="rec_chassi" placeholder="17 caracteres">
          </div>
          <div class="form-item">
            <label for="rec_cor">Cor</label>
            <input type="text" id="rec_cor" placeholder="Cor do veículo">
          </div>
        </div>

        <div class="doc-actions">
          <button class="btn btn-recebimento" type="button" onclick="gerarProcuracaoRecebimento()">
            Gerar Procuração
            de Recebimento do Usado</button>
        </div>
      </div>

      <!-- =========================
           3) TERMO DE QUITAÇÃO
           ========================= -->
      <div class="doc-card hidden" id="doc-quitacao">
        <div class="head">
          <div class="doc-title-pill doc-title-quit">TERMO DE QUITAÇÃO (ENTRADA DE TERCEIRO)</div>
        </div>

        <div class="section-title">Dados do Cliente (Anuente)</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="quit_nomeCompleto">Nome Completo</label>
            <input type="text" id="quit_nomeCompleto" placeholder="Nome completo do cliente">
          </div>
          <div class="form-item">
            <label for="quit_cpfCnpj">CPF/CNPJ</label>
            <input type="text" id="quit_cpfCnpj" placeholder="000.000.000-00">
          </div>
          <div class="form-item">
            <label for="quit_cidade">Cidade</label>
            <input type="text" id="quit_cidade" placeholder="Nome da cidade">
          </div>
        </div>

        <div class="section-title">Veículo Entregue (Entrada)</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="quit_modelo">Modelo do Veículo</label>
            <input type="text" id="quit_modelo" placeholder="Ex: CHEVROLET/ONIX">
          </div>
          <div class="form-item">
            <label for="quit_anoModelo">Ano/Modelo</label>
            <input type="text" id="quit_anoModelo" placeholder="2020/2021">
          </div>
          <div class="form-item">
            <label for="quit_placa">Placa</label>
            <input type="text" id="quit_placa" placeholder="ABC1D23">
          </div>
          <div class="form-item">
            <label for="quit_chassi">Chassi</label>
            <input type="text" id="quit_chassi" placeholder="17 caracteres">
          </div>
          <div class="form-item">
            <label for="quit_cor">Cor</label>
            <input type="text" id="quit_cor" placeholder="Cor do veículo">
          </div>
        </div>

        <div class="section-title">Dados do Cedente (Terceiro)</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="quit_cedenteNome">Nome/Razão Social do Cedente</label>
            <input type="text" id="quit_cedenteNome" placeholder="Nome completo / Razão social">
          </div>
          <div class="form-item">
            <label for="quit_cedenteCpfCnpj">CPF/CNPJ do Cedente</label>
            <input type="text" id="quit_cedenteCpfCnpj" placeholder="000.000.000-00">
          </div>
          <div class="form-item">
            <label for="quit_cedenteEndereco">Endereço do Cedente</label>
            <input type="text" id="quit_cedenteEndereco" placeholder="Rua/av">
          </div>
          <div class="form-item">
            <label for="quit_cedenteNumero">Número</label>
            <input type="text" id="quit_cedenteNumero" placeholder="nº">
          </div>
        </div>

        <div class="section-title">Veículo Adquirido / Contrato</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="quit_veiculoAdquiridoModelo">Modelo do veículo adquirido</label>
            <input type="text" id="quit_veiculoAdquiridoModelo" placeholder="Ex: FIAT/FASTBACK IMPETUS">
          </div>
          <div class="form-item">
            <label for="quit_veiculoAdquiridoAnoModelo">Ano/Modelo do veículo adquirido</label>
            <input type="text" id="quit_veiculoAdquiridoAnoModelo" placeholder="2024/2025">
          </div>
          <div class="form-item">
            <label for="quit_veiculoAdquiridoCor">Cor do veículo adquirido</label>
            <input type="text" id="quit_veiculoAdquiridoCor" placeholder="Cor">
          </div>
          <div class="form-item">
            <label for="quit_veiculoAdquiridoChassi">Chassi do veículo adquirido</label>
            <input type="text" id="quit_veiculoAdquiridoChassi" placeholder="17 caracteres" maxlength="17">
          </div>
          <div class="form-item">
            <label for="quit_contratoNumero">Contrato nº</label>
            <input type="text" id="quit_contratoNumero" placeholder="Número do contrato">
          </div>
          <div class="form-item">
            <label for="quit_valorQuitacao">Valor (R$) da quitação</label>
            <input type="text" id="quit_valorQuitacao" inputmode="decimal" placeholder="Ex: 30000 ou 30.000,00">
          </div>
        </div>

        <p class="helper"><strong></strong></p>

        <div class="doc-actions">
          <button class="btn btn-quitacao" type="button" onclick="gerarTermoQuitacaoTerceiro()"> Gerar
            Termo de
            Quitação (Terceiro)</button>
        </div>
      </div>

      <!-- =========================
           4) INSTRUMENTO RESPONSABILIDADE
           ========================= -->
      <div class="doc-card hidden" id="doc-instrumento">
        <div class="head">
          <div class="doc-title-pill doc-title-inst">INSTRUMENTO DE RESPONSABILIDADE</div>
        </div>

        <div class="section-title">Dados do Cliente</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="inst_nomeCompleto">Nome Completo</label>
            <input type="text" id="inst_nomeCompleto" placeholder="Nome completo do cliente">
          </div>
          <div class="form-item">
            <label for="inst_cpfCnpj">CPF/CNPJ</label>
            <input type="text" id="inst_cpfCnpj" placeholder="000.000.000-00">
          </div>
          <div class="form-item">
            <label for="inst_cidade">Cidade</label>
            <input type="text" id="inst_cidade" placeholder="Nome da cidade">
          </div>
          <div class="form-item">
            <label for="inst_placa">Placa (opcional p/ nome do arquivo)</label>
            <input type="text" id="inst_placa" placeholder="ABC1D23 (opcional)">
          </div>
        </div>

        <div class="section-title">Dados do Veículo</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="inst_modelo">Modelo do Veículo</label>
            <input type="text" id="inst_modelo" placeholder="Ex: FIAT/FASTBACK">
          </div>
          <div class="form-item">
            <label for="inst_chassi">Chassi</label>
            <input type="text" id="inst_chassi" placeholder="17 caracteres">
          </div>
        </div>

        <div class="section-title">Dados de Entrega</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="inst_dataEntrega">Data da entrega</label>
            <input type="text" id="inst_dataEntrega" inputmode="numeric" placeholder="dd/mm/aaaa" maxlength="10">
          </div>
          <div class="form-item">
            <label for="inst_horaEntrega">Hora da entrega</label>
            <input type="text" id="inst_horaEntrega" inputmode="numeric" placeholder="hh:mm" maxlength="5">
          </div>
        </div>

        <p class="helper">Dica: ao digitar apenas números, o sistema coloca as barras/“:”
          automaticamente (ex.: 10122025
          → 10/12/2025).</p>

        <div class="doc-actions">
          <button class="btn btn-responsabilidade" type="button" onclick="gerarInstrumentoResponsabilidade()"> Gerar
            Instrumento de Responsabilidade</button>
        </div>
      </div>

      <!-- =========================
           5) DECLARAÇÃO DE RESIDÊNCIA (placa removida)
           ========================= -->
      <div class="doc-card hidden" id="doc-residencia">
        <div class="head">
          <div class="doc-title-pill doc-title-res">DECLARAÇÃO DE RESIDÊNCIA</div>
        </div>

        <div class="section-title">Dados do Declarante</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="res_nomeCompleto">Nome Completo</label>
            <input type="text" id="res_nomeCompleto" placeholder="Nome completo do cliente">
          </div>
          <div class="form-item">
            <label for="res_cpfCnpj">CPF</label>
            <input type="text" id="res_cpfCnpj" placeholder="000.000.000-00">
          </div>
          <div class="form-item">
            <label for="res_endereco">Endereço</label>
            <input type="text" id="res_endereco" placeholder="Rua/av, número, complemento">
          </div>
          <div class="form-item">
            <label for="res_bairro">Bairro</label>
            <input type="text" id="res_bairro" placeholder="Nome do bairro">
          </div>
          <div class="form-item">
            <label for="res_cidade">Cidade</label>
            <input type="text" id="res_cidade" placeholder="Nome da cidade">
          </div>
          <div class="form-item">
            <label for="res_estado">Estado</label>
            <input type="text" id="res_estado" placeholder="Sigla do Estado">
          </div>
        </div>

        <div class="doc-actions">
          <button class="btn btn-residencia" type="button" onclick="gerarDeclaracaoResidencia()"> Gerar
            Declaração de
            Residência</button>
        </div>
      </div>

      <!-- =========================
           6) DECLARAÇÃO DE DEPÓSITO PARA TERCEIROS
           ========================= -->
      <div class="doc-card hidden" id="doc-deposito">
        <div class="head">
          <div class="doc-title-pill doc-title-dep">DECLARAÇÃO DE DEPÓSITO PARA TERCEIROS</div>
        </div>

        <div class="section-title">Dados do Declarante</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="dep_nomeCompleto">Nome Completo</label>
            <input type="text" id="dep_nomeCompleto" placeholder="Nome completo do declarante">
          </div>
          <div class="form-item">
            <label for="dep_cpfCnpj">CPF/CNPJ</label>
            <input type="text" id="dep_cpfCnpj" placeholder="000.000.000-00">
          </div>

        </div>

        <div class="section-title">Dados do Depósito</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="dep_valor">Valor do depósito</label>
            <input type="text" id="dep_valor" inputmode="decimal" placeholder="Ex: 300 ou 300,00">
          </div>
          <div class="form-item">
            <label for="dep_valorExtenso">Valor por extenso (opcional)</label>
            <input type="text" id="dep_valorExtenso" placeholder="Ex: trezentos reais">
          </div>
          <div class="form-item">
            <label for="dep_dataDeposito">Data do depósito</label>
            <input type="text" id="dep_dataDeposito" inputmode="numeric" placeholder="dd/mm/aaaa" maxlength="10">
          </div>
        </div>

        <div class="section-title">Dados Bancários (San Marino)</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="dep_banco">Banco</label>
            <input type="text" id="dep_banco" placeholder="Ex: ITAU" value="ITAU">
          </div>
          <div class="form-item">
            <label for="dep_agencia">Agência</label>
            <input type="text" id="dep_agencia" placeholder="Ex: 0280" value="0280">
          </div>
          <div class="form-item">
            <label for="dep_conta">Conta Corrente</label>
            <input type="text" id="dep_conta" placeholder="Ex: 00110-8" value="00110-8">
          </div>
        </div>

        <div class="section-title">Dados do Veículo e do Faturamento</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="dep_chassiPlaca">Chassi/Placa</label>
            <input type="text" id="dep_chassiPlaca" placeholder="Informe o chassi e/ou placa">
          </div>
          <div class="form-item">
            <label for="dep_faturadoNome">Faturado em nome de</label>
            <input type="text" id="dep_faturadoNome" placeholder="Nome / Razão social">
          </div>
          <div class="form-item">
            <label for="dep_faturadoCpfCnpj">CPF/CNPJ do faturado</label>
            <input type="text" id="dep_faturadoCpfCnpj" placeholder="000.000.000-00">
          </div>
        </div>

        <div class="section-title">Local e Data (linha superior)</div>
        <div class="form-grid">
          <div class="form-item">
            <label for="dep_cidade">Cidade</label>
            <input type="text" id="dep_cidade" placeholder="Ex: Porto Alegre" value="">
          </div>
          <div class="form-item">
            <label for="dep_dia">Dia</label>
            <input type="text" id="dep_dia" inputmode="numeric" placeholder="Ex: 13" maxlength="2">
          </div>
          <div class="form-item">
            <label for="dep_mesExtenso">Mês (por extenso)</label>
            <input type="text" id="dep_mesExtenso" placeholder="Ex: abril">
          </div>
          <div class="form-item">
            <label for="dep_ano">Ano</label>
            <input type="text" id="dep_ano" inputmode="numeric" placeholder="2026" maxlength="9">
          </div>
        </div>

        <p class="helper"> <strong></strong></p>

        <div class="doc-actions">
          <button class="btn btn-deposito" type="button" onclick="gerarDeclaracaoDepositoTerceiros()">
            Gerar
            Declaração de Depósito para Terceiros</button>
        </div>
      </div>

      <!-- =========================
           7) ORÇAMENTO DETRAN
           ========================= -->
      <div class="doc-card hidden" id="doc-orcamento">
        <div class="head no-print">
          <div class="doc-title-pill"
            style="color: #f59e0b; background: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3);">
            ORÇAMENTO DETRAN</div>
        </div>

        <div class="orc-card" id="printable-orcamento">
          <header class="orc-header">
            <h1>ORÇAMENTO PARA TRANSFERÊNCIA OU EMPLACAMENTO DE VEÍCULOS</h1>
          </header>

          <div class="orc-grid">
            <div class="orc-field">
              <label class="orc-label">Despachante:</label>
              <input type="text" class="orc-input" id="orc_despachante" value="RAMIRO ILHA" style="color: #000;">
            </div>
            <div class="orc-field">
              <label class="orc-label">Loja:</label>
              <input type="text" class="orc-input" id="orc_loja" value="SAN MARINO VEÍCULOS" style="color: #000;">
            </div>
            <div class="orc-field">
              <label class="orc-label">Data do Recibo:</label>
              <input type="text" class="orc-input" id="orc_dataRecibo" style="color: #000;">
            </div>
            <div class="orc-field">
              <label class="orc-label">Placas/Chassis:</label>
              <input type="text" class="orc-input" id="orc_placa" placeholder="Ex: JDO1234">
            </div>
            <div class="orc-field">
              <label class="orc-label">Ano/Modelo/Cor:</label>
              <input type="text" class="orc-input" id="orc_anoModeloCor" placeholder="Ex: 2025/2026">
            </div>
            <div class="orc-field">
              <label class="orc-label">Veículo:</label>
              <input type="text" class="orc-input" id="orc_veiculo" placeholder="Ex: TITANO RANCH">
            </div>
            <div class="orc-field">
              <label class="orc-label">Proprietário:</label>
              <input type="text" class="orc-input" id="orc_proprietario">
            </div>
            <div class="orc-field">
              <label class="orc-label">CPF/CNPJ:</label>
              <input type="text" class="orc-input" id="orc_cpfCnpj">
            </div>
          </div>

          <div style="margin: 0.5rem 0;">
            <label class="orc-label">Observações:</label>
            <div id="orc_obs" class="orc-field obs-placeholder" contenteditable="true"
              style="min-height: 1.8rem; font-size: 0.75rem; font-weight: 900; background: #fbfbfb;"
              placeholder="digite aqui as observações"></div>
          </div>

          <table class="orc-table">
            <thead>
              <tr>
                <th>SERVIÇOS</th>
                <th style="width: 70px; text-align: center;">SOMA?</th>
                <th style="width: 140px; text-align: right;">VALORES (R$)</th>
              </tr>
            </thead>
            <tbody id="orc-body">
              <tr>
                <td>Honorários devidos ao despachante</td>
                <td style="text-align: center;"></td>
                <td style="text-align: right;" class="orc-price">150,00</td>
              </tr>
              <tr>
                <td>Serviços Prestados pela Concessionária:</td>
                <td style="text-align: center;"></td>
                <td style="text-align: right;" class="orc-price">850,00</td>
              </tr>
              <tr>
                <td>IPVA/RS - Parcela Anual 2026</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price" contenteditable="true"
                  oninput="updateOrcamentoTotal()">0,00</td>
              </tr>
              <tr>
                <td>Taxa de EMPLACAMENTO ou TRANSFERÊNCIA de propriedade</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price" contenteditable="true"
                  oninput="updateOrcamentoTotal()">1.330,00</td>
              </tr>
              <tr>
                <td>Taxa Vistoria – DETRAN/RS</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price">114,11</td>
              </tr>
              <tr>
                <td>Taxa de Expedição – CRLV</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price">360,00</td>
              </tr>
              <tr>
                <td>Escolha de Placa (Opcional ) – DETRAN/RS</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price">519,33</td>
              </tr>
              <tr>
                <td>Confecção Placa Metálica Oficial – Agente credenciado</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price">370,00</td>
              </tr>
              <tr>
                <td>Comunicação de Venda</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price">50,98</td>
              </tr>
              <tr>
                <td>Seguro Placa Verde</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price">20,00</td>
              </tr>
              <tr>
                <td>Cartório/Cópias</td>
                <td style="text-align: center;"><input type="checkbox" class="orc-check"
                    onchange="updateOrcamentoTotal()" checked></td>
                <td style="text-align: right;" class="orc-price" contenteditable="true"
                  oninput="updateOrcamentoTotal()">0,00</td>
              </tr>
              <tr style="background: #fdf2f2;">
                <td style="font-weight: 900; color: #dc2626;">DESCONTO</td>
                <td style="text-align: center;"></td>
                <td style="text-align: right; color: #dc2626;" class="orc-price" contenteditable="true"
                  id="orc_desconto" oninput="updateOrcamentoTotal()">0,00</td>
              </tr>
            </tbody>
          </table>

          <div class="orc-total-box">
            <div style="font-weight: 900; text-transform: uppercase;">Valor Consolidado:</div>
            <div class="orc-total-amt" id="orc-total">R$ 0,00</div>
          </div>

          <div class="orc-legal">
            <div style="color: red; text-align: center; font-weight: 900; margin-bottom: 0.5rem;">É
              DIREITO DO
              CONSUMIDOR A LIVRE ESCOLHA DE DESPACHANTE.</div>
            <p>PODE O CLIENTE OPTAR PELA CONTRATAÇÃO DE OUTRO PROFISSIONAL QUE NÃO O INDICADO PELA
              CONCESSIONÁRIA.</p>
            <p>CASO O CLIENTE OPTE PELA CONTRATAÇÃO DE OUTRO DESPACHANTE (DIVERSO DO INDICADO), A
              CONCESSIONÁRIA FICA
              DESOBRIGADA DAS SEGUINTES RESPONSABILIDADES, CABENDO-AS AO CONSUMIDOR:</p>
            <p>a) AO DESLOCAMENTO, RETIRADA, LOCOMOÇÃO, CONDUTOR E SEGURO DO VEÍCULO;</p>
            <p>b) PELO FORNECIMENTO DE PLACAS VERDES PARA A CIRCULAÇÃO DO VEÍCULO ADQUIRIDO ANTES DE
              EMPLACADO,
              PROVIDÊNCIAS QUE FICARÃO A CARGO DO CLIENTE, INCLUSIVE COM A CONTRATAÇÃO DE GUINCHO/AUTO
              PLATAFORMAS, CASO
              NECESSÁRIA, PARA A RETIRADA DO VEÍCULO DA CONCESSIONÁRIA.</p>
            <p>A CONCESSIONÁRIA NÃO SE RESPONSABILIZA POR EVENTUAL ATRASO NO REGISTRO E EMPLACAMENTO DO
              VEÍCULO, BEM
              COMO POR EVENTUAIS PREJUÍZOS E ENTRAVES QUE VENHAM A OCORRER.</p>
          </div>

          <div class="orc-sigs">
            <div>
              <div class="orc-sig-line">Responsável Técnico</div>
            </div>
            <div>
              <div class="orc-sig-line">Assinatura do Cliente</div>
            </div>
          </div>
        </div>

        <div class="doc-actions no-print">
          <button class="btn btn-acordo" type="button" onclick="gerarOrcamentoDetran()"
            style="background: linear-gradient(135deg, #f59e0b, #fbbf24); color: #111827;"> Gerar PDF do
            Orçamento</button>
        </div>
      </div>

      <!-- =========================
           8) TEXTO CONTRATUAL
           ========================= -->
      <div class="doc-card hidden" id="doc-contrato">
        <div class="head">
          <div class="doc-title-pill doc-title-contrato">TEXTO CONTRATUAL</div>
        </div>

        <div class="section-title"
          style="border-top: none; margin-top: 0; padding-top: 0; text-align: center; margin-bottom: 15px;">
          Escolha a Modalidade de Venda, copie o texto e cole no contrato</div>

        <div class="tabs-contrato">
          <button class="tab-contrato active" id="tab-tradicional" type="button"
            onclick="selecionarModalidade('tradicional')">
            Garantia em Dobro
          </button>
          <button class="tab-contrato" id="tab-outlet" type="button" onclick="selecionarModalidade('outlet')">
            Outlet
          </button>
        </div>

        <textarea class="texto-contratual" id="texto-contratual" readonly></textarea>

        <div class="doc-actions">
          <button class="btn btn-contrato" type="button" onclick="copiarTextoContratual()"> Copiar
            Texto</button>
        </div>
      </div>


      <!-- =========================
           9) CALCULADORA DE JUROS (Cartão)
           ========================= -->
      <div class="doc-card hidden" id="doc-calculadora">



        <!-- Campo de valor em cima -->
        <div class="calc-input-grid">
          <div class="form-item" style="gap:6px; margin:0;">
            <label style="color: var(--muted); font-weight:900;">Digite o valor no campo ao lado</label>
          </div>

          <div class="calc-input-wrap">
            <span class="calc-prefix">R$</span>
            <input id="calc_baseValue" class="calc-input" type="text" inputmode="decimal"
              placeholder="Ex.: 10.000,00" />
          </div>

          <button class="btn" id="calc_btnLimpar" type="button" style="min-width:unset; width:100%;">Limpar</button>
        </div>

        <!-- Botões de banco -->
        <div class="calc-bank-row" aria-label="Seleção de operadora">
          <button class="calc-bank-btn rede" id="calc_btnRede" type="button" title="Selecionar REDE">
            <span class="calc-bank-dot"></span> REDE
          </button>
          <button class="calc-bank-btn banri" id="calc_btnBanri" type="button" title="Selecionar BANRICOMPRAS">
            <span class="calc-bank-dot"></span> BANRICOMPRAS
          </button>
        </div>

        <div id="calc_emptyState" class="calc-empty-state">
          Selecione <strong>REDE</strong> ou <strong>BANRICOMPRAS</strong> para exibir as taxas e o
          cálculo.
        </div>

        <div id="calc_content" class="hidden">
          <div class="calc-table-wrap" aria-label="Tabela (rolagem horizontal no mobile)">
            <table class="calc-sheet" aria-label="Tabela de taxas e cálculo">
              <thead>
                <tr>
                  <th style="width:34%;">Modalidade/Parcelas</th>
                  <th class="center" style="width:14%;">Taxa</th>
                  <th class="center" style="width:14%;">Fator</th>
                  <th class="center" style="width:16%;">Valor a cobrar</th>
                  <th class="center calc-highlight calc-sep" style="width:12%;">Quantidade de parcelas
                  </th>
                  <th class="center calc-highlight" style="width:14%;">Valor da parcela</th>
                </tr>
              </thead>
              <tbody id="calc_tbody"></tbody>
            </table>
          </div>

          <div class="calc-rotate-note">
            No celular em <strong>modo retrato</strong>, deslize a tabela para o lado (rolagem
            horizontal). Se preferir,
            gire a tela para <strong>horizontal</strong> para ver tudo de uma vez.
          </div>
        </div>

      </div>


      <!-- =========================
           10) LINKS ÚTEIS
           ========================= -->
      <div class="doc-card hidden" id="doc-links">
        <div style="height: 10px;"></div>

        <div class="link-section">
          <div class="cover-grid">
            <a href="https://veiculos.fipe.org.br/" target="_blank" class="cover-btn" style="text-decoration: none;">
              <div class="cover-doc-pill">TABELA FIPE</div>
            </a>
            <a href="https://www.sefaz.rs.gov.br/apps/ipva/principal/tabs/meus-veiculos" target="_blank"
              class="cover-btn" style="text-decoration: none;">
              <div class="cover-doc-pill">VALOR DE IPVA</div>
            </a>
            <a href="https://pcsdetran.rs.gov.br/login?redirectUrl=%2Fconsulta-veiculo" target="_blank"
              class="cover-btn" style="text-decoration: none;">
              <div class="cover-doc-pill">SITUAÇÃO DO DETRAN</div>
            </a>
            <a href="https://www.vichinsky.com.br/hp12c/hp12c.php" target="_blank" class="cover-btn"
              style="text-decoration: none;">
              <div class="cover-doc-pill">HP12C ONLINE</div>
            </a>
          </div>
        </div>

      </div>

    </div>

    <div class="footer">
      Desenvolvido por Alberto Mateus para o Grupo San Marino
      | <span style="opacity: 0.85;">Visitas: <span id="visitas-count">...</span></span>
    </div>
  </div>

  <script>

    function replicarDadosCliente() {
      const campos = {
        nomeCompleto: document.getElementById('global_nomeCompleto').value.toUpperCase(),
        cpfCnpj: document.getElementById('global_cpfCnpj').value.toUpperCase(),
        endereco: document.getElementById('global_endereco').value.toUpperCase(),
        bairro: document.getElementById('global_bairro').value.toUpperCase(),
        cep: document.getElementById('global_cep').value.toUpperCase(),
        cidade: document.getElementById('global_cidade').value.toUpperCase(),
        estado: document.getElementById('global_estado').value.toUpperCase()
      };

      // Mapeamento de campos globais para campos locais
      const mapa = {
        'acordo_nomeCompleto': campos.nomeCompleto, 'acordo_cpfCnpj': campos.cpfCnpj, 'acordo_endereco': campos.endereco, 'acordo_bairro': campos.bairro, 'acordo_cep': campos.cep, 'acordo_cidade': campos.cidade, 'acordo_estado': campos.estado,
        'rec_nomeCompleto': campos.nomeCompleto, 'rec_cpfCnpj': campos.cpfCnpj, 'rec_endereco': campos.endereco, 'rec_bairro': campos.bairro, 'rec_cidade': campos.cidade, 'rec_estado': campos.estado,
        'quit_nomeCompleto': campos.nomeCompleto, 'quit_cpfCnpj': campos.cpfCnpj, 'quit_cidade': campos.cidade,
        'res_nomeCompleto': campos.nomeCompleto, 'res_cpfCnpj': campos.cpfCnpj, 'res_endereco': campos.endereco, 'res_bairro': campos.bairro, 'res_cidade': campos.cidade, 'res_estado': campos.estado,
        'dep_nomeCompleto': campos.nomeCompleto, 'dep_cpfCnpj': campos.cpfCnpj, 'dep_cidade': campos.cidade,
        'inst_nomeCompleto': campos.nomeCompleto, 'inst_cpfCnpj': campos.cpfCnpj, 'inst_cidade': campos.cidade,
        'orc_proprietario': campos.nomeCompleto, 'orc_cpfCnpj': campos.cpfCnpj
      };

      for (let id in mapa) {
        const el = document.getElementById(id);
        if (el) el.value = mapa[id];
      }
    }

    /* =========================
       CAPA (abre 1 documento por vez)
       ========================= */
    function alternarSecao(secao) {
      // Esconder todas as seções e cards
      document.getElementById('secao-gerador').classList.add('hidden');
      document.getElementById('doc-calculadora').classList.add('hidden');
      document.getElementById('doc-contrato').classList.add('hidden');
      document.getElementById('doc-links').classList.add('hidden');
      document.getElementById('secao-bancos').classList.add('hidden');
      document.getElementById('secao-certidoes').classList.add('hidden');
      document.getElementById('secao-venda-direta').classList.add('hidden');
      document.getElementById('secao-plataformas').classList.add('hidden');
      document.getElementById('secao-cartas').classList.add('hidden');
      document.getElementById('secao-seminovos').classList.add('hidden');
      document.getElementById('secao-gestor').classList.add('hidden');
      document.getElementById('secao-pos-vendas').classList.add('hidden');
      document.getElementById('secao-lojas').classList.add('hidden');
      document.getElementById('dados-cliente-global').classList.add('hidden');

      // Esconder todos os cards de documentos individuais
      const cards = document.querySelectorAll('.doc-card');
      cards.forEach(c => c.classList.add('hidden'));

      // Remover classe active de todos os botões de navegação
      document.getElementById('btn-gerador').classList.remove('active');
      document.getElementById('btn-calculadora').classList.remove('active');
      document.getElementById('btn-links').classList.remove('active');
      document.getElementById('btn-bancos').classList.remove('active');
      document.getElementById('btn-certidoes').classList.remove('active');
      document.getElementById('btn-venda-direta').classList.remove('active');
      document.getElementById('btn-plataformas').classList.remove('active');
      document.getElementById('btn-cartas').classList.remove('active');
      document.getElementById('btn-seminovos').classList.remove('active');
      document.getElementById('btn-gestor').classList.remove('active');
      document.getElementById('btn-pos-vendas').classList.remove('active');
      document.getElementById('btn-lojas').classList.remove('active');

      if (secao === 'gerador') {
        document.getElementById('secao-gerador').classList.remove('hidden');
        document.getElementById('btn-gerador').classList.add('active');
      } else if (secao === 'calculadora') {
        document.getElementById('doc-calculadora').classList.remove('hidden');
        document.getElementById('btn-calculadora').classList.add('active');
      } else if (secao === 'links') {
        document.getElementById('doc-links').classList.remove('hidden');
        document.getElementById('btn-links').classList.add('active');
      } else if (secao === 'bancos') {
        document.getElementById('secao-bancos').classList.remove('hidden');
        document.getElementById('btn-bancos').classList.add('active');
      } else if (secao === 'certidoes') {
        document.getElementById('secao-certidoes').classList.remove('hidden');
        document.getElementById('btn-certidoes').classList.add('active');
      } else if (secao === 'venda-direta') {
        document.getElementById('secao-venda-direta').classList.remove('hidden');
        document.getElementById('btn-venda-direta').classList.add('active');
      } else if (secao === 'plataformas') {
        document.getElementById('secao-plataformas').classList.remove('hidden');
        document.getElementById('btn-plataformas').classList.add('active');
      } else if (secao === 'cartas') {
        document.getElementById('secao-cartas').classList.remove('hidden');
        document.getElementById('btn-cartas').classList.add('active');
      } else if (secao === 'seminovos') {
        document.getElementById('secao-seminovos').classList.remove('hidden');
        document.getElementById('btn-seminovos').classList.add('active');
      } else if (secao === 'gestor') {
        document.getElementById('secao-gestor').classList.remove('hidden');
        document.getElementById('btn-gestor').classList.add('active');
      } else if (secao === 'pos-vendas') {
        document.getElementById('secao-pos-vendas').classList.remove('hidden');
        document.getElementById('btn-pos-vendas').classList.add('active');
      } else if (secao === 'lojas') {
        document.getElementById('secao-lojas').classList.remove('hidden');
        document.getElementById('btn-lojas').classList.add('active');
      }
    }

    async function copiarLink(url) {
      try {
        await navigator.clipboard.writeText(url);
        showToast('Link copiado para o WhatsApp!', 'success');
      } catch (err) {
        showToast('Erro ao copiar link.', 'error');
      }
    }

    function abrirDocumento(docId) {
      // 1. Remove classe ACTIVE de todos os botões da capa
      const coverBtns = document.querySelectorAll('.cover-btn');
      coverBtns.forEach(btn => btn.classList.remove('active'));

      // 2. Adiciona classe ACTIVE no botão correspondente
      const btnIdMap = {
        'doc-recebimento': 'btn-doc-recebimento',
        'doc-acordo': 'btn-doc-acordo',
        'doc-instrumento': 'btn-doc-instrumento',
        'doc-quitacao': 'btn-doc-quitacao',
        'doc-residencia': 'btn-doc-residencia',
        'doc-deposito': 'btn-doc-deposito',
        'doc-orcamento': 'btn-doc-orcamento'
      };

      if (btnIdMap[docId]) {
        const btn = document.getElementById(btnIdMap[docId]);
        if (btn) btn.classList.add('active');
      }

      // Esconder apenas os cards de documentos, mantendo o submenu visível se necessário
      const cards = document.querySelectorAll('.doc-card');
      cards.forEach(c => {
        if (c.id !== 'doc-calculadora' && c.id !== 'doc-contrato' && c.id !== 'doc-links') {
          c.classList.add('hidden');
        }
      });

      const el = document.getElementById(docId);
      if (el) {
        el.classList.remove('hidden');
        // Mostrar dados do cliente se for um documento do gerador
        if (docId !== 'doc-calculadora' && docId !== 'doc-contrato' && docId !== 'doc-links') {
          document.getElementById('dados-cliente-global').classList.remove('hidden');
        }
        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      // Se abrir o card de contrato, inicializar com o texto tradicional
      if (docId === 'doc-contrato') {
        selecionarModalidade('tradicional');
      }
    }

    /* =========================
       TEXTO CONTRATUAL
       ========================= */
    const textoOutlet = `Declaro estar ciente de que o veículo adquirido se encontra enquadrado na Modalidade de Venda OUTLET, a qual se caracteriza por condições comerciais diferenciadas com o veículo podendo incluir características estéticas visíveis nas peças de lataria e pneus, desgaste natural compatível com o tempo de uso e demais particularidades previamente informadas e disponíveis para vistoria.

Em razão da natureza desta modalidade de venda OUTLET, declaro estar ciente que a garantia aplicável ao veículo objeto deste contrato será restrita única e exclusivamente aos componentes de MOTOR e CAIXA DE CÂMBIO, pelo prazo legal de 90 (noventa) dias, conforme previsto no artigo 26, inciso II, do Código de Defesa do Consumidor.

Declaro estar ciente que nenhuma outra garantia está inclusa, sendo excluída qualquer cobertura relativa a itens de desgaste natural, peças elétricas, eletrônicas, suspensão, freios, lataria, pintura, sistemas de entretenimento, acessórios, vibrações, avarias decorrentes de uso inadequado ou qualquer outro componente que não seja relacionado a motor e caixa de câmbio.

Declaro que tive oportunidade de vistoriar o veículo antes da compra e que concordo com as condições descritas acima referente a modalidade de venda OUTLET.`;

    const textoTradicional = `O Código de Defesa do Consumidor, em seu artigo 26, inciso II, estabelece que o consumidor tem direito a 90 dias de garantia na compra de um veículo seminovo. A San Marino, por meio da campanha GARANTIA EM DOBRO, oferece a você, nosso cliente, 90 dias adicionais, totalizando 180 dias de garantia para o veículo objeto deste contrato. Esta garantia estendida, do dia 91 até o dia 180, abrange única e exclusivamente defeitos no motor e na caixa de câmbio.`;

    function selecionarModalidade(modalidade) {
      const tabTradicional = document.getElementById('tab-tradicional');
      const tabOutlet = document.getElementById('tab-outlet');
      const textarea = document.getElementById('texto-contratual');

      if (modalidade === 'tradicional') {
        tabTradicional.classList.add('active');
        tabOutlet.classList.remove('active');
        textarea.value = textoTradicional;
      } else {
        tabOutlet.classList.add('active');
        tabTradicional.classList.remove('active');
        textarea.value = textoOutlet;
      }
    }

    async function copiarTextoContratual() {
      const textarea = document.getElementById('texto-contratual');
      try {
        await navigator.clipboard.writeText(textarea.value);
        showToast('Texto copiado com sucesso!', 'success');
      } catch (err) {
        showToast('Erro ao copiar texto. Tente novamente.', 'error');
      }
    }

    /* =========================
       UI
       ========================= */
    // Toast Notification System
    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      if (!container) return;

      const toast = document.createElement('div');
      toast.className = `toast ${type}`;

      let icon = '';
      if (type === 'success') icon = '<i class="fa-solid fa-circle-check"></i>';
      else if (type === 'error') icon = '<i class="fa-solid fa-circle-exclamation"></i>';
      else if (type === 'info') icon = '<i class="fa-solid fa-circle-info"></i>';

      toast.innerHTML = `
        ${icon}
        <span style="flex: 1;">${message}</span>
        <i class="fa-solid fa-xmark" style="font-size: 14px; opacity: 0.5; cursor: pointer;"></i>
      `;

      container.appendChild(toast);

      const removeToast = () => {
        toast.classList.add('toast-exiting');
        setTimeout(() => toast.remove(), 400);
      };

      const autoRemove = setTimeout(removeToast, 5000);

      toast.onclick = () => {
        clearTimeout(autoRemove);
        removeToast();
      };
    }

    /* =========================
       Máscaras (DATA e HORA)
       ========================= */
    function applyDateMask(el) {
      if (!el) return;
      el.addEventListener('input', () => {
        let v = (el.value || '').replace(/\D/g, '').slice(0, 8); // ddmmyyyy
        if (v.length >= 5) {
          el.value = v.slice(0, 2) + '/' + v.slice(2, 4) + '/' + v.slice(4);
        } else if (v.length >= 3) {
          el.value = v.slice(0, 2) + '/' + v.slice(2);
        } else {
          el.value = v;
        }
      });
    }

    function applyTimeMask(el) {
      if (!el) return;
      el.addEventListener('input', () => {
        let v = (el.value || '').replace(/\D/g, '').slice(0, 4); // hhmm
        if (v.length >= 3) {
          el.value = v.slice(0, 2) + ':' + v.slice(2);
        } else {
          el.value = v;
        }
      });
    }


    /* =========================
       Máscara ANO/MODELO (AAAA/AAAA)
       ========================= */
    function applyAnoModeloMask(el) {
      if (!el) return;
      el.addEventListener('input', () => {
        // Mantém somente números e limita em 8 dígitos (AAAAMMMM)
        let v = (el.value || '').replace(/\D/g, '').slice(0, 8);

        // Insere a barra após o 4º dígito
        if (v.length >= 5) {
          el.value = v.slice(0, 4) + '/' + v.slice(4);
        } else {
          el.value = v;
        }
      });
    }

    /* =========================
       Formatação moeda BRL
       ========================= */
    function normalizeToAscii(str) {
      if (!str) return '';
      return str.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    }

    function parseCurrencyToNumberBR(value) {
      const v = (value || '').toString().trim();
      if (!v) return NaN;

      let s = v.replace(/R\$\s?/gi, '').replace(/\s/g, '');
      s = s.replace(/\./g, '').replace(',', '.');
      const n = Number(s);
      return Number.isFinite(n) ? n : NaN;
    }

    function formatBRL(n) {
      if (!Number.isFinite(n)) return '';
      const formatted = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(n);
      return formatted.replace(/\u00A0/g, ' ');
    }

    function attachCurrencyBehavior(el) {
      if (!el) return;
      el.addEventListener('blur', () => {
        const value = el.innerText !== undefined ? el.innerText : el.value;
        const n = parseCurrencyToNumberBR(value);
        if (Number.isFinite(n)) {
          const formatted = formatBRL(n);
          if (el.innerText !== undefined) el.innerText = formatted;
          else el.value = formatted;
        }
      });
    }

    /* =========================
       Helpers de dados
       ========================= */
    function formatarAnoModelo(s) {
      if (!s) return s;
      if (!s.includes('/')) return s;
      const [a1, a2] = s.split('/');
      return (a1.trim().length === 2 ? '20' + a1.trim() : a1.trim()) + '/' + (a2.trim().length === 2 ? '20' + a2.trim() : a2.trim());
    }

    function upperOr(v, fallback) {
      const t = (v || '').trim();
      return t ? t.toUpperCase() : (fallback || '');
    }

    function sanitizeForFilename(str) {
      const s = normalizeToAscii((str || '').trim()).toUpperCase();
      const cleaned = s.replace(/[^A-Z0-9]+/g, '_').replace(/_+/g, '_').replace(/^_+|_+$/g, '');
      return cleaned || 'SEM_DADO';
    }

    function nomeCurtoParaArquivo(nomeCompleto) {
      const n = normalizeToAscii((nomeCompleto || '').trim());
      if (!n) return 'CLIENTE';
      const parts = n.split(/\s+/).filter(Boolean);
      if (parts.length === 1) return parts[0];
      return parts[0] + '_' + parts[parts.length - 1];
    }

    function buildFilename(prefix, placa, nomeCompleto) {
      const p = sanitizeForFilename(placa || 'SEM_PLACA');
      const n = sanitizeForFilename(nomeCurtoParaArquivo(nomeCompleto));
      const pre = sanitizeForFilename(prefix);
      return `${pre}_${p}_${n}.pdf`;
    }

    /* =========================
       Coleta de dados (INDIVIDUAL)
       ========================= */
    function obterDadosAcordo() {
      return {
        nomeCompleto: document.getElementById('acordo_nomeCompleto').value.trim(),
        cpfCnpj: document.getElementById('acordo_cpfCnpj').value.trim(),
        endereco: document.getElementById('acordo_endereco').value.trim(),
        bairro: document.getElementById('acordo_bairro').value.trim(),
        cep: document.getElementById('acordo_cep').value.trim(),
        cidade: document.getElementById('acordo_cidade').value.trim(),
        estado: document.getElementById('acordo_estado').value.trim(),

        modelo: document.getElementById('acordo_modelo').value.trim(),
        placa: document.getElementById('acordo_placa').value.trim(),
        anoModelo: document.getElementById('acordo_anoModelo').value.trim(),
        chassi: document.getElementById('acordo_chassi').value.trim(),
        renavam: document.getElementById('acordo_renavam').value.trim(),
        cor: document.getElementById('acordo_cor').value.trim()
      };
    }

    function obterDadosRecebimento() {
      return {
        nomeCompleto: document.getElementById('rec_nomeCompleto').value.trim(),
        cpfCnpj: document.getElementById('rec_cpfCnpj').value.trim(),
        endereco: document.getElementById('rec_endereco').value.trim(),
        bairro: document.getElementById('rec_bairro').value.trim(),
        cidade: document.getElementById('rec_cidade').value.trim(),
        estado: document.getElementById('rec_estado').value.trim(),

        modelo: document.getElementById('rec_modelo').value.trim(),
        placa: document.getElementById('rec_placa').value.trim(),
        anoModelo: document.getElementById('rec_anoModelo').value.trim(),
        chassi: document.getElementById('rec_chassi').value.trim(),
        cor: document.getElementById('rec_cor').value.trim()
      };
    }

    function obterDadosResidencia() {
      return {
        nomeCompleto: document.getElementById('res_nomeCompleto').value.trim(),
        cpfCnpj: document.getElementById('res_cpfCnpj').value.trim(),
        endereco: document.getElementById('res_endereco').value.trim(),
        bairro: document.getElementById('res_bairro').value.trim(),
        cidade: document.getElementById('res_cidade').value.trim(),
        estado: document.getElementById('res_estado').value.trim()
      };
    }

    function obterDadosDepositoTerceiros() {
      return {
        nomeCompleto: document.getElementById('dep_nomeCompleto').value.trim(),
        cpfCnpj: document.getElementById('dep_cpfCnpj').value.trim(),
        rg: (document.getElementById('dep_rg')?.value || '').trim(),

        valor: document.getElementById('dep_valor').value.trim(),
        valorExtenso: document.getElementById('dep_valorExtenso').value.trim(),
        dataDeposito: document.getElementById('dep_dataDeposito').value.trim(),

        banco: document.getElementById('dep_banco').value.trim(),
        agencia: document.getElementById('dep_agencia').value.trim(),
        conta: document.getElementById('dep_conta').value.trim(),

        chassiPlaca: document.getElementById('dep_chassiPlaca').value.trim(),
        faturadoNome: document.getElementById('dep_faturadoNome').value.trim(),
        faturadoCpfCnpj: document.getElementById('dep_faturadoCpfCnpj').value.trim(),

        cidade: document.getElementById('dep_cidade').value.trim(),
        dia: document.getElementById('dep_dia').value.trim(),
        mesExtenso: document.getElementById('dep_mesExtenso').value.trim(),
        ano: document.getElementById('dep_ano').value.trim()
      };
    }

    function obterDadosInstrumento() {
      return {
        nomeCompleto: document.getElementById('inst_nomeCompleto').value.trim(),
        cpfCnpj: document.getElementById('inst_cpfCnpj').value.trim(),
        cidade: document.getElementById('inst_cidade').value.trim(),
        placa: document.getElementById('inst_placa').value.trim(),

        modelo: document.getElementById('inst_modelo').value.trim(),
        chassi: document.getElementById('inst_chassi').value.trim(),

        dataEntrega: document.getElementById('inst_dataEntrega').value.trim(),
        horaEntrega: document.getElementById('inst_horaEntrega').value.trim()
      };
    }

    function obterDadosQuitacao() {
      return {
        nomeCompleto: document.getElementById('quit_nomeCompleto').value.trim(),
        cpfCnpj: document.getElementById('quit_cpfCnpj').value.trim(),
        cidade: document.getElementById('quit_cidade').value.trim(),

        modelo: document.getElementById('quit_modelo').value.trim(),
        anoModelo: document.getElementById('quit_anoModelo').value.trim(),
        placa: document.getElementById('quit_placa').value.trim(),
        chassi: document.getElementById('quit_chassi').value.trim(),
        cor: document.getElementById('quit_cor').value.trim(),

        cedenteNome: document.getElementById('quit_cedenteNome').value.trim(),
        cedenteCpfCnpj: document.getElementById('quit_cedenteCpfCnpj').value.trim(),
        cedenteEndereco: document.getElementById('quit_cedenteEndereco').value.trim(),
        cedenteNumero: document.getElementById('quit_cedenteNumero').value.trim(),

        veiculoAdquiridoModelo: document.getElementById('quit_veiculoAdquiridoModelo').value.trim(),
        veiculoAdquiridoAnoModelo: document.getElementById('quit_veiculoAdquiridoAnoModelo').value.trim(),
        veiculoAdquiridoCor: document.getElementById('quit_veiculoAdquiridoCor').value.trim(),
        veiculoAdquiridoChassi: document.getElementById('quit_veiculoAdquiridoChassi').value.trim(),
        contratoNumero: document.getElementById('quit_contratoNumero').value.trim(),
        valorQuitacao: document.getElementById('quit_valorQuitacao').value.trim()
      };
    }

    /* =========================
       Padronização do PDF (A4)
       ========================= */
    const PDF_LAYOUT = {
      pageWidth: 210,
      pageHeight: 297,
      marginLeft: 25,
      marginRight: 25,
      marginTop: 65,
      marginBottom: 25,
      firstLineIndent: 10,
      paragraphGap: 6
    };

    // ==============================
    // Logomarca da San Marino
    //
    // Esta constante armazena a imagem da logo em formato
    // base64 (data URI). Ela é utilizada para adicionar a logo
    // no canto superior esquerdo de todos os PDFs gerados.
    // A imagem original foi redimensionada para reduzir o
    // tamanho do arquivo incorporado.
    const SAN_MARINO_LOGO = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCACPAMgDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7LooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKK8g+OfjTVofGfhH4XeGtT/sjVfFEzm41IAGS0tIwS5iDcea+GVSc4weM4wAev5+v5UVwVj8IvAkEAE2mXN/ckfPeXuoXE9zI3djIz7s/THtit/TLLRvBejTCbV7iHTxKZBJqmpPKIQQBsEkzEheOASepoA3qK57SvHXgrVtRXTdL8XaDe3r/AHLeDUInkb6KGyfwrRutc0W11m20W51jT4dTulL29nJcos8yjPKoTuYfK3IHY+lAGhQSAMk4rnYvHXgqXVBpcfi7QHv2fy1thqMRkL5xtC7sk+3Wua+OmoyDSrDQ7Ukz384JVTyVUjA/Fiv5VzYzErDUZVWr2/E5Mdi1hMPKs1e3Tu+iPQri4t7ePzZ54okJxudwoz9TTJb2zihSeS6gSKT7jtIArfQ55ridSt4NPgisVgiuY9B01RHG6hlku5vkj4Pfg/8Af2odQ0+CG2k02GKGUabaQ6RZ74lK/aZ9u9wCMZCmNv8AvqtozbV2tTpg24pyVmehCSMqrh1KsMqc8GnV8Z/to+Jo7XVv7C0+TyrXQtNW2iRWwFlkUdMei+X+Rr668LMW8NaY5JJNnCSSck/ItTTq+0cklonY9jMsr+oUaEpSvKpHntb4U37ut9bpX2VjSor5Z/aB+IE3jD46eD/g9oNzKthHrNvLrUsTEec6PvMII6qiqxb/AGsDqpr6V1vXdE0K3W41rV7DTYWJ2vd3CRBj6AsRk1qeSaNFc3oPj3wVr2p/2Xo/irRr6/27haw3iGUj1CZyR7gVfbxJ4fXxF/wjh1vThrPk+f8AYPtKfaPL/v7M7tvvigDVorlj498FXljqz2fjXQgNNj/02dL6J1s93yqz84HzevBPFch8HrbTfhz4Pt18UfFeHxLN4ivzcWWoX96qpcM4UKkG523A8HAJyW4AoA9YormNY+IPgbR9QfT9V8X6HZXUbbZIp76NDG3o2T8p9jiujgmhnt0uIZUlhkUOkiMGVlIyCCOCMd6AJKK5O5+Jfw9trxrOfxt4ejmR9jq2oRYRum1jnAPsTXVRSRyxJLE6vG6hlZTkMD0IPcUAOooooAKKKKACvG/2kvgp/wALQi07WdF1htF8T6QCLK5JYI6lgwVivzIQwyHXkZPBzx6tr+qW+i6Rcapdx3MlvbqGlFvbvM4XIBIRAWIGcnAPAJrIt/H/AIGuLD7fF4x8Pm1xkynUYgq/XLcfQ0AfNHgn4w/Fz4XeO9K8D/GXT2v9Pv50t7fUmCmQBmCiRZU+WZQWG4EBwDk+h+ptZ0Xw/f3VvqOsaZp1zNZhhBNdQo5h3EZ2lh8pOByPSvAPjFen4u6tpt74P099V8N+C/tGtXGqeUfIv7uKMmG0tyRmXLKN5XK4I5zjNP8AZ2j8Dax8NIviN8UdZ03xH4i1S4maRtVlF01viQokENuc7TxkIiZO4ADGKAH/ALR0lr40+Pfwq8B6I0DT294dVurq2Kl4YkYHAZfu/LFIceu2qHgvQ7b4yftWeNfFGoSzvoHhlF0mCOKUqtwcMjIWHPlkiZmAI3BgDwSDyvgPxHouk/ET4xfFh7C00F9DsnsNG0mSFLWaOQjYuYRjaxMaZ46yN6V7V+xX4Wfw78DNP1C6Um+16V9UuHYfMwfiPJ90VW/4EaAOS/bVhtLjQfA/wt0CwtLe91zWoxbRwRKgt40+TKgD5RulXp2U16BaRf2/8Y0iMjS2mhxBd7nOTGMZPuXbP/Aa8u1HWLTX/wBtHWdW1SeGK08CaMUsYLhgrTXBTqqnluZXOR/dU+lel/Du0mj8FajqBb/TteuhZQv3wxIZh9MyN/wCvJx377EUqHS/M/Rbfezxcx/f4qhhul+d+kdvvZ0llNHdz2l3cNtiup5tauC3G2CIBYM/h5bf8BNLpkixNa3mo/uktLabXL8kfceXcEB/3U8wf8AFFxGl2bqCBdseoXkekwKva2gBM2PY4mX/AL5ri/jj4hXTfhVrN9HIq3HiO9+yW+Dz9nT5cj2Kox/7a13VJqnByfTU+oyvAyzDGUsLHeckvv3fyWp8r/HKC81zwLqHxAvCwOoeIzboM8ZaGWVh+H7sCvtXXNfv9P8AA/h7RPD7IfEeuWsVtp29dywARKZblx/ciQ7j6sUXqwr50/ao8Or4a/ZU8GadKoiuH1VJ7jPH7yW3mYg+4yB/wGvoL4O6Xef2SvjrxNA9nqF3p0MFrazEbtOsI0BWM+juQZZPcqv/ACzFPDQcKST3/wAz0OJsdHG5nVqU/gT5Y/4Y+6rfdf5nhXwp0Oyu/wBtzULPTQ8mneDtLeCN5W3O0ixrG7u38TtLPM7HqWJNfVeo2Hh6LU01vULTTEvkjESXk8aCRUBJ2h25AyScA96+MfgbreuW3gD43/F/RUaTV55StpKqeYYy8jSyPjvsWVG9Pl5r1b4L6d8M9P8AhVovinxbNp3ivxRrVstzPNeEalfXE78+TFG25srkLtUDkEnHJrc8Ez/iBdQePv2z/BGj6VPE9r4Usm1K9uoSDgn59hcfw/6kYz/G1YnwI8Nn4w/Gfx98S9VnlPhx7w6bDbqcfbYk27YnYc+UESIso++WAPy7geK8BeJrDQvh18Zfijiy0vWdYun0jTNPQpHLaK7cgRjldokXt1iNfT37LfhL/hDPgb4c02SLy7u4tvt10O/mTfPg+4Uqv/AaAPC/2lvh94W8E6ZYeA/ANg9trHxD1yJLnMxfbBHIGEaL0SMSyIcD+73wMaHjPw7a+PP2ovCnwx0+e5t/D/gLR0lna1fY6MAhAVh91j/o65HI+bGDzVy/1bTfEH7bmoalr95b2ml+A9GJgS5cIXl2biyqT83+tc5H9xa1v2JrK417/hNfivqUf+l+J9XdYCeqwoxbA9tz7f8AtmKAN79q+80XwD+zbrOk6Xp1raRaiqaba28UQClpDlmx3bYrtk5ORnOa848F2mueMdW8PfAKDUbuz8NeFNHgm8XTW8pSW7nYBjZhwchAz7CARna/90VuftL3Nv4o/aN+GXw/1GaC20i1kOsXrXLiOOXDEhMtgH5YWX/tpVv9mGS28KfEr4p6T4vu7fTvEd9rhvVF3IIzdWrNIySxlsb0y5PGcZGaAPdLjRPC+ieCbnSDpOn2vh6C0kWa0WBVgEIU7gVxjGAc5ryL9g+81G7+BQ+2SzPaQ6rcxacJGJKW42kKM9g5cD8al+N/i2/+IdncfCr4Vypql/qWINZ1eBt1lpdsf9YHlX5TIw+XYpJwT3xXrHw68Kab4H8E6V4U0kN9k063ESsw+aRurO3uzEsfrQBv0UUUAFFFFABWTeeGfDt5eG9u9B0q4uScmaWzjd8+u4rmtaigBERUQIihVUYAAwAKzLTw7oFnqT6naaJplvfOSXuYrSNJWz1y4GT+dalFAGXf+HdAv7prq+0TTLqdhtaWa0jdyPTJGa0YYo4IUhhjSOKNQqIigKoAwAAOgp9FAFC70TRru+W+utJsJ7tBhZ5LZGkA9mIzT7rStMurSO0udOtJreNt6RPCpRW55AxgHk/mauUUrK9xWV7mfNoeiz2kFpNpNjJb2+fJia3UrHnrtGMD8KfcaTpVxbw29xptnLDANsMbwKyxjGMKCMDgDpV2inYuMnF3i7Mrahp9hqEKQ39lbXcSOHVJ4ldVYdCAQcH3qwyqylWAKkYII4NLRQSVNO0zTtOtmttPsLW0gZizRwQrGpJGCSFAHQVX0rw9oOlXMlzpeiabYzyf6yS2tY42f6lQCa06KAMq68N+Hrq4luLnQtLmmm/1sklnGzPznkkZPPrWqAFAAAAHAAoooAz77Q9Fvrxby90jT7m5UYWaa2R3AxjAYjPQmrNhZ2lhapa2NrBa26Z2RQxhEXJycAcDmp6KAKOqaPpOqmP+09Msr3yzlPtFukm36bgcdKbrOh6LrSImsaRYaikZyi3VskoX6bgcVoUUAQWFlZ2FqlrY2sFrbpwkUMYRF+gHAqeiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9k=';

    function createDocA4() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: 'mm', format: 'a4' });
      doc.setFont('times', 'normal');
      doc.setFontSize(12);
      doc.setLineHeightFactor(1.6);
      // Insere a logomarca da San Marino no canto superior esquerdo
      // Aumentado para 60mm de largura e 43mm de altura
      doc.addImage(SAN_MARINO_LOGO, 'JPEG', PDF_LAYOUT.marginLeft, 5, 60, 43);
      return doc;
    }

    function contentWidth() {
      return PDF_LAYOUT.pageWidth - PDF_LAYOUT.marginLeft - PDF_LAYOUT.marginRight;
    }

    function ensureSpace(doc, y, needed) {
      const bottomLimit = PDF_LAYOUT.pageHeight - PDF_LAYOUT.marginBottom;
      if (y + needed > bottomLimit) {
        doc.addPage();
        doc.setFont('times', 'normal');
        doc.setFontSize(12);
        doc.setLineHeightFactor(1.6);
        return PDF_LAYOUT.marginTop;
      }
      return y;
    }

    function addTitle(doc, title, subtitle, opts) {
      const options = opts || {};
      const titleSize = options.titleSize || 14;
      const subtitleSize = options.subtitleSize || 12;
      const gapAfter = options.gapAfter ?? 10;

      let y = PDF_LAYOUT.marginTop;
      const centerX = PDF_LAYOUT.pageWidth / 2;

      doc.setFont('times', 'bold');
      doc.setFontSize(titleSize);
      doc.text(String(title || '').toUpperCase(), centerX, y, { align: 'center' });
      y += 7;

      if (subtitle) {
        doc.setFontSize(subtitleSize);
        const sub = String(subtitle || '').toUpperCase();
        const lines = doc.splitTextToSize(sub, contentWidth());
        doc.text(lines, centerX, y, { align: 'center' });
        y += (lines.length * 6) + 4;
      } else {
        y += 6;
      }

      doc.setFont('times', 'normal');
      doc.setFontSize(12);
      doc.setLineHeightFactor(1.6);

      return y + gapAfter;
    }

    function addLocalDataLinha(doc, y, cidade) {
      y = ensureSpace(doc, y, 18);
      doc.setFont('times', 'normal');
      doc.setFontSize(12);
      doc.text(`${upperOr(cidade, '____________________')}, ____ de ____________________ de ________.`, PDF_LAYOUT.pageWidth / 2, y, { align: 'center' });
      return y + 15;
    }

    function addAssinaturaSimples(doc, y, label) {
      y = ensureSpace(doc, y, 28);
      const center = PDF_LAYOUT.pageWidth / 2;
      doc.line(center - 55, y, center + 55, y);
      y += 6;
      doc.setFont('times', 'normal');
      doc.setFontSize(10);
      doc.text(label || 'Assinatura', center, y, { align: 'center' });
      return y + 8;
    }

    function addAssinaturasDuplas(doc, y, leftLabel, rightLabel) {
      y = ensureSpace(doc, y, 35);
      doc.line(PDF_LAYOUT.marginLeft, y, PDF_LAYOUT.marginLeft + 70, y);
      doc.line(PDF_LAYOUT.pageWidth - PDF_LAYOUT.marginRight - 70, y, PDF_LAYOUT.pageWidth - PDF_LAYOUT.marginRight, y);
      y += 6;
      doc.setFont('times', 'normal');
      doc.setFontSize(10);
      doc.text(leftLabel || 'Assinatura', PDF_LAYOUT.marginLeft + 35, y, { align: 'center' });
      doc.text(rightLabel || 'Assinatura', PDF_LAYOUT.pageWidth - PDF_LAYOUT.marginRight - 35, y, { align: 'center' });
      return y + 10;
    }

    /* =========================
       Texto justificado (normal)
       ========================= */
    function drawJustifiedParagraph(doc, text, x, y, maxWidth, indentFirstLineMm) {
      const raw = (text || '').replace(/\s+/g, ' ').trim();
      if (!raw) return y;

      const indent = Math.max(0, indentFirstLineMm || 0);

      const words = raw.split(' ').filter(Boolean).map(t => ({ text: t }));
      const baseSpaceWidth = doc.getTextWidth(' ');
      const lineHeight = doc.getTextDimensions('Mg').h * doc.getLineHeightFactor();

      function buildLines(targetWidthFirst, targetWidthOther) {
        const lines = [];
        let current = [];
        let isFirstLine = true;

        function lineWidth(ws) {
          let total = 0;
          for (let i = 0; i < ws.length; i++) {
            total += doc.getTextWidth(ws[i].text);
            if (i < ws.length - 1) total += baseSpaceWidth;
          }
          return total;
        }

        for (const w of words) {
          const targetW = isFirstLine ? targetWidthFirst : targetWidthOther;

          if (current.length === 0) {
            current.push(w);
            continue;
          }

          const tentative = current.concat([w]);
          const total = lineWidth(tentative);

          if (total > targetW) {
            lines.push({ words: current, isFirstLine });
            current = [w];
            isFirstLine = false;
          } else {
            current = tentative;
          }
        }
        if (current.length) lines.push({ words: current, isFirstLine });
        return lines;
      }

      const lines = buildLines(maxWidth - indent, maxWidth);

      for (let li = 0; li < lines.length; li++) {
        const { words: lineWords, isFirstLine } = lines[li];
        const isLastLine = (li === lines.length - 1);

        const targetW = isFirstLine ? (maxWidth - indent) : maxWidth;
        const startX = isFirstLine ? (x + indent) : x;

        let wordsOnlyWidth = 0;
        for (const w of lineWords) wordsOnlyWidth += doc.getTextWidth(w.text);

        const numSpaces = Math.max(0, lineWords.length - 1);

        let extraPerSpace = 0;
        if (!isLastLine && numSpaces > 0) {
          const baseLineWidth = wordsOnlyWidth + (numSpaces * baseSpaceWidth);
          const extra = targetW - baseLineWidth;
          extraPerSpace = extra > 0 ? (extra / numSpaces) : 0;
        }

        let cx = startX;
        for (let wi = 0; wi < lineWords.length; wi++) {
          const w = lineWords[wi];
          doc.text(w.text, cx, y);
          cx += doc.getTextWidth(w.text);
          if (wi < lineWords.length - 1) cx += baseSpaceWidth + extraPerSpace;
        }

        y += lineHeight;
        y = ensureSpace(doc, y, lineHeight + 2);
      }

      return y;
    }

    /* =========================
       Texto justificado com negrito (segmentos)
       ========================= */
    function desenharParagrafoJustificadoComNegrito(doc, segments, x, y, maxWidth, indentFirstLineMm) {
      const indent = Math.max(0, indentFirstLineMm || 0);

      const words = [];
      for (const seg of segments) {
        const style = seg.style === 'bold' ? 'bold' : 'normal';
        const parts = (seg.text || '').trim().split(/\s+/).filter(Boolean);
        for (const p of parts) words.push({ text: p, style });
      }

      const baseSpaceWidth = doc.getTextWidth(' ');
      const lineHeight = doc.getTextDimensions('Mg').h * doc.getLineHeightFactor();

      function wordWidth(w) {
        doc.setFont('times', w.style);
        return doc.getTextWidth(w.text);
      }

      function lineWidth(ws) {
        let total = 0;
        for (let i = 0; i < ws.length; i++) {
          total += ws[i]._w;
          if (i < ws.length - 1) total += baseSpaceWidth;
        }
        return total;
      }

      const lines = [];
      let current = [];
      let isFirstLine = true;

      for (const w of words) {
        const wW = wordWidth(w);
        const ww = { ...w, _w: wW };
        const targetW = isFirstLine ? (maxWidth - indent) : maxWidth;

        if (current.length === 0) {
          current.push(ww);
          continue;
        }

        const tentative = current.concat([ww]);
        const total = lineWidth(tentative);

        if (total > targetW) {
          lines.push({ words: current, isFirstLine });
          current = [ww];
          isFirstLine = false;
        } else {
          current = tentative;
        }
      }
      if (current.length) lines.push({ words: current, isFirstLine });

      for (let li = 0; li < lines.length; li++) {
        const { words: lineWords, isFirstLine } = lines[li];
        const isLastLine = (li === lines.length - 1);

        const targetW = isFirstLine ? (maxWidth - indent) : maxWidth;
        const startX = isFirstLine ? (x + indent) : x;

        let wordsOnlyWidth = 0;
        for (const w of lineWords) wordsOnlyWidth += w._w;

        const numSpaces = Math.max(0, lineWords.length - 1);

        let extraPerSpace = 0;
        if (!isLastLine && numSpaces > 0) {
          const baseLineWidth = wordsOnlyWidth + (numSpaces * baseSpaceWidth);
          const extra = targetW - baseLineWidth;
          extraPerSpace = extra > 0 ? (extra / numSpaces) : 0;
        }

        let cx = startX;
        for (let wi = 0; wi < lineWords.length; wi++) {
          const w = lineWords[wi];
          doc.setFont('times', w.style);
          doc.text(w.text, cx, y);
          cx += w._w;
          if (wi < lineWords.length - 1) cx += baseSpaceWidth + extraPerSpace;
        }

        doc.setFont('times', 'normal');

        y += lineHeight;
        y = ensureSpace(doc, y, lineHeight + 2);
      }

      return y;
    }

    /* =========================
       Documentos
       ========================= */
    function gerarProcuracaoAcordo() {
      const dados = obterDadosAcordo();

      if (!dados.nomeCompleto || !dados.cpfCnpj || !dados.placa) {
        showToast('Para a Procuração de Acordo, preencha pelo menos o nome completo, CPF/CNPJ e placa do veículo.', 'error');
        return;
      }

      if (dados.chassi && dados.chassi.length !== 17) {
        showToast('O campo Chassi deve ter exatamente 17 caracteres.', 'error');
        return;
      }

      if (dados.renavam && dados.renavam.length !== 11) {
        showToast('O campo Renavam deve ter exatamente 11 caracteres.', 'error');
        return;
      }

      const doc = createDocA4();
      const x = PDF_LAYOUT.marginLeft;
      const w = contentWidth();

      let {
        nomeCompleto, cpfCnpj, endereco, bairro, cep, cidade, estado,
        modelo, placa, anoModelo, chassi, renavam, cor
      } = dados;

      anoModelo = formatarAnoModelo(anoModelo);

      let y = addTitle(doc, 'Procuração', null);

      // Ajuste para caber em uma página: fonte 11 e espaçamento menor entre linhas
      doc.setFontSize(11);
      doc.setLineHeightFactor(1.35);

      const p1 = `Por este instrumento particular de procuração, ${upperOr(nomeCompleto, '')}, CPF/CNPJ: ${cpfCnpj}, ENDEREÇO: ${upperOr(endereco, 'NÃO INFORMADO')}, BAIRRO: ${upperOr(bairro, 'NÃO INFORMADO')}, CEP: ${cep || 'NÃO INFORMADO'}, CIDADE: ${upperOr(cidade, 'NÃO INFORMADO')}, ESTADO: ${upperOr(estado, 'NÃO INFORMADO')}.`;
      y = drawJustifiedParagraph(doc, p1, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += PDF_LAYOUT.paragraphGap;

      const segmentosT2 = [
        { style: 'normal', text: 'Dados pelos quais responsabilizo-me civil e criminalmente, nomeio e constituo meu bastante procurador:' },
        { style: 'bold', text: 'Rafael Pickrodt de Castro' },
        { style: 'normal', text: ', portador do CPF: 030.571.800-27 e RG: 2090921905, domiciliado na Rua Alexio Fagherazzi Nº37, na cidade de Porto Alegre; e/ou' },
        { style: 'bold', text: 'Ramiro Ilha' },
        { style: 'normal', text: ', portador do CPF: 375.722.450-72 e RG: 9021949971, domiciliado na Rua Dr. Voltaire Pires, 430 / 1, na cidade de Porto Alegre; e/ou' },
        { style: 'bold', text: 'Alessandra de Souza Santos' },
        { style: 'normal', text: ', portadora do CPF: 971.624.000-78 e RG: 1077846771, domiciliada na Rua Eloema de Oliveira Barcelos, 446, na cidade de Porto Alegre; para os fins específicos de “assinar a GRT – Guia de Responsabilidade Técnica” e também o “de acordo” na compra do veículo descrito abaixo, bem como assinar outros requerimentos, junto ao DETRAN/RS, com a finalidade de proceder com a realização de emplacamento/transferência do veículo objeto deste documento:' }
      ];

      y = ensureSpace(doc, y, 12);
      y = desenharParagrafoJustificadoComNegrito(doc, segmentosT2, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += PDF_LAYOUT.paragraphGap + 2;

      y = ensureSpace(doc, y, 50);
      doc.setFont('times', 'bold');
      doc.text(`MODELO DO VEÍCULO: ${upperOr(modelo, 'NÃO INFORMADO')}`, x, y); y += 6;
      doc.text(`PLACA: ${upperOr(placa, 'SEM PLACA')}`, x, y); y += 6;
      doc.text(`ANO/MODELO: ${anoModelo || 'NÃO INFORMADO'}`, x, y); y += 6;
      doc.text(`CHASSI: ${upperOr(chassi, 'NÃO INFORMADO')}`, x, y); y += 6;
      doc.text(`RENAVAM: ${renavam || 'NÃO INFORMADO'}`, x, y); y += 6;
      doc.text(`COR: ${upperOr(cor, 'NÃO INFORMADO')}`, x, y); y += 25;
      doc.setFont('times', 'normal');

      y = addLocalDataLinha(doc, y, cidade);
      y = addAssinaturaSimples(doc, y, '(Assinatura reconhecida por autenticidade)');

      doc.save(buildFilename('PROCURACAO_ACORDO', placa, nomeCompleto));
      showToast('PDF da Procuração de Acordo gerado com sucesso!', 'success');
    }

    function gerarProcuracaoRecebimento() {
      const dados = obterDadosRecebimento();

      if (!dados.nomeCompleto || !dados.placa) {
        showToast('Para a Procuração de Recebimento, preencha pelo menos o nome do cliente e a placa do veículo.', 'error');
        return;
      }

      if (dados.chassi && dados.chassi.length !== 17) {
        showToast('O campo Chassi deve ter exatamente 17 caracteres.', 'error');
        return;
      }

      // ======== FORMATAÇÃO (COPIADA DO ANTIGO) PARA CABER EM 1 PÁGINA ========
      const doc = createDocA4();

      let {
        nomeCompleto, cpfCnpj, endereco, bairro, cidade, estado,
        modelo, placa, anoModelo, chassi, cor
      } = dados;

      anoModelo = formatarAnoModelo(anoModelo);

      // Título
      doc.setFont('times', 'bold');
      doc.setFontSize(14);
      doc.text('PROCURAÇÃO DE RECEBIMENTO DO USADO', PDF_LAYOUT.pageWidth / 2, PDF_LAYOUT.marginTop - 15, { align: 'center' });

      // Corpo (compacto)
      doc.setFont('times', 'normal');
      doc.setFontSize(10);
      doc.setLineHeightFactor(1.3);

      const m = 20, w = 170;
      let y = PDF_LAYOUT.marginTop + 10;

      // Outorgante
      const outorgante = `Outorgante: ${upperOr(nomeCompleto, 'NÃO INFORMADO')} inscrito no CPF/CNPJ sob o nº ${cpfCnpj || 'NÃO INFORMADO'} com endereço: ${upperOr(endereco, 'NÃO INFORMADO')} Bairro: ${upperOr(bairro, 'NÃO INFORMADO')} na cidade de ${upperOr(cidade, 'NÃO INFORMADO')} Estado: ${upperOr(estado, 'NÃO INFORMADO')}.`;
      doc.text(outorgante, m, y, { maxWidth: w, align: 'justify' });
      y += doc.getTextDimensions(outorgante, { maxWidth: w }).h + 4;

      // Outorgado
      const outorgado = 'Outorgado: San Marino Veículos Ltda., situada na Av. Ipiranga, 7110, Bairro Jardim Botânico, na cidade Porto Alegre, Estado Rio Grande do Sul, inscrita no CNPJ sob n.º 90.446.618/0001-72 e inscrição estadual n.º 0960799613.';
      doc.text(outorgado, m, y, { maxWidth: w, align: 'justify' });
      y += doc.getTextDimensions(outorgado, { maxWidth: w }).h + 6;

      // Objeto
      doc.text('Objeto: O objeto desta procuração é o veículo abaixo descrito:', m, y);
      y += 9;

      // Dados do veículo
      doc.setFont('times', 'bold');
      doc.text(`MODELO DO VEÍCULO: ${upperOr(modelo, 'NÃO INFORMADO')}`, m, y); y += 6;
      doc.text(`PLACA: ${upperOr(placa, 'SEM PLACA')}`, m, y); y += 6;
      doc.text(`ANO/MODELO: ${anoModelo || 'NÃO INFORMADO'}`, m, y); y += 6;
      doc.text(`CHASSI: ${upperOr(chassi, 'NÃO INFORMADO')}`, m, y); y += 6;
      doc.text(`COR: ${upperOr(cor, 'NÃO INFORMADO')}`, m, y); y += 10;

      doc.setFont('times', 'normal');

      // Poderes
      const poderes = 'Poderes: O Outorgante, nomeia e constitui seu procurador, o OUTORGADO, para o fim especial de:';
      doc.text(poderes, m, y, { maxWidth: w });
      y += doc.getTextDimensions(poderes, { maxWidth: w }).h + 6;

      const itens = [
        'a) permutar, vender sem prestar contas e a quem melhor interessar, fazer dação em pagamento, aceitar e instituir cláusulas seguidas das demais formalidades relativas a venda do veículo de propriedade do outorgante, acima descrito;',
        'b) receber valores, no todo ou em parcelas, dar e receber quitação, ceder e transigir, desistir, firmar acordo ou compromisso;',
        'c) requerer documentos e/ou informações perante repartições e registros públicos;',
        'd) efetuar qualquer espécie de procedimento ou de processo administrativo relativo ao veículo junto à Divisão de Trânsito;',
        'e) proceder a liquidação das despesas do mesmo no que se refere às multas, transferência de propriedade tanto para terceiro quanto em favor do outorgado;',
        'f) o outorgante, nos casos em que o veículo estiver pendente de quitação na modalidade de leasing junto a instituição financeira, concede os poderes especiais para o outorgado assinar e representa-lo como comprador perante a esta instituição financeira e ao Detran e, posteriormente, na qualidade de vendedor a quem ao outorgado interessar;',
        'g) solicitar e retirar segunda via de CRV e CRLV junto à Divisão de Trânsito;',
        'h) em relação as multas e/ou outras pendências que envolvam valores anteriores à data da venda do veículo para o outorgado, o outorgado resguarda-se o direito de efetuar os devidos pagamentos e proceder com a cobrança em relação ao outorgante, de forma administrativa e/ou judicial;',
        'i) para os atos posteriores e de interesse exclusivo do outorgado, o mesmo compromete-se a assumir todos os encargos daí decorrentes;',
        'j) por fim, o outorgado poderá praticar os atos, por mais especiais que sejam, que se façam necessários ou úteis ao fiel desempenho deste mandato.'
      ];

      // Itens (mais compactos, como no ANTIGO)
      doc.setFontSize(9);
      for (const item of itens) {
        doc.text(item, m, y, { maxWidth: w, align: 'justify' });
        y += doc.getTextDimensions(item, { maxWidth: w }).h + 2;
      }

      // Local/Data + assinatura (sem quebra de página)
      y += 8;
      doc.setFontSize(10);
      doc.text('CIDADE: ____________________, ESTADO: ____, ____ de __________ de ________.', PDF_LAYOUT.pageWidth / 2, y, { align: 'center' });
      y += 22;

      doc.line(70, y, 140, y);
      y += 5;
      doc.text('Outorgante', PDF_LAYOUT.pageWidth / 2, y, { align: 'center' });

      doc.save(buildFilename('PROCURACAO_RECEBIMENTO', placa, nomeCompleto));
      showToast('PDF da Procuração de Recebimento gerado com sucesso!', 'success');
    }

    function gerarDeclaracaoResidencia() {
      const dados = obterDadosResidencia();

      if (!dados.nomeCompleto || !dados.cpfCnpj || !dados.endereco) {
        showToast('Para a Declaração de Residência, preencha pelo menos o nome completo, CPF e endereço.', 'error');
        return;
      }

      const doc = createDocA4();
      const x = PDF_LAYOUT.marginLeft;
      const w = contentWidth();

      let { nomeCompleto, cpfCnpj, endereco, bairro, cidade, estado } = dados;

      let y = addTitle(doc, 'Declaração de Residência', null);

      const p1 = `Eu, ${upperOr(nomeCompleto, '')}, CPF: ${cpfCnpj}, declaro sob as penas da lei que resido à ${upperOr(endereco, '')}, Bairro: ${upperOr(bairro, 'NÃO INFORMADO')}, Cidade: ${upperOr(cidade, 'NÃO INFORMADO')}, Estado: ${upperOr(estado, 'NÃO INFORMADO')}.`;
      y = drawJustifiedParagraph(doc, p1, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += PDF_LAYOUT.paragraphGap;

      const p2 = 'Declaro-me ainda, Civil e Criminalmente responsável pela veracidade da declaração prestada.';
      y = drawJustifiedParagraph(doc, p2, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += 12;

      y = ensureSpace(doc, y, 18);
      doc.text(`${upperOr(cidade, '____________________')}, ______ DE ____________________ 20_______`, PDF_LAYOUT.pageWidth / 2, y, { align: 'center' });
      y += 20;

      y = addAssinaturaSimples(doc, y, 'Assinatura conforme documento apresentado');

      doc.save(buildFilename('DECLARACAO_RESIDENCIA', '', nomeCompleto));
      showToast('PDF da Declaração de Residência gerado com sucesso!', 'success');
    }

    function gerarDeclaracaoDepositoTerceiros() {
      const dados = obterDadosDepositoTerceiros();

      if (!dados.nomeCompleto || !dados.cpfCnpj || !dados.valor) {
        showToast('Para a Declaração de Depósito, preencha pelo menos: nome completo, CPF/CNPJ e valor do depósito.', 'error');
        return;
      }

      const doc = createDocA4();
      const x = PDF_LAYOUT.marginLeft;
      const w = contentWidth();

      const nomeCompleto = dados.nomeCompleto;
      const cpfCnpj = dados.cpfCnpj;
      // const rg = dados.rg || '_______________';

      const nValor = parseCurrencyToNumberBR(dados.valor);
      const valorFmt = Number.isFinite(nValor) ? formatBRL(nValor) : (dados.valor || '________________');
      const valorExt = dados.valorExtenso ? dados.valorExtenso : '________________';

      const banco = upperOr(dados.banco, 'ITAU');
      const agencia = dados.agencia || '0280';
      const conta = dados.conta || '00110-8';
      const dataDeposito = (dados.dataDeposito && dados.dataDeposito.includes('/')) ? dados.dataDeposito : (dados.dataDeposito || '____/____/________');

      const chassiPlaca = dados.chassiPlaca ? dados.chassiPlaca : '______________________________';
      const faturadoNome = dados.faturadoNome ? dados.faturadoNome : '______________________________________';
      const faturadoCpfCnpj = dados.faturadoCpfCnpj ? dados.faturadoCpfCnpj : '____________________________';

      const cidadeLinha = upperOr(dados.cidade, 'Porto Alegre');
      const diaLinha = dados.dia ? dados.dia : '_______';
      const mesLinha = dados.mesExtenso ? dados.mesExtenso : '________________________';
      const anoLinha = dados.ano ? dados.ano : '2025';

      let y = addTitle(doc, 'Declaração de Depósito', 'Para Terceiros');

      // Linha local/data (modelo do arquivo ODT)
      y = ensureSpace(doc, y, 12);
      doc.setFont('times', 'normal');
      doc.setFontSize(12);
      doc.text(`${cidadeLinha}, ${diaLinha} de ${mesLinha} de ${anoLinha}.`, x, y);
      y += 14;

      const texto = `Eu, ${upperOr(nomeCompleto, '')}, portador (a) do CPF/CNPJ.: ${cpfCnpj || '___________________'}, declaro que fiz um depósito no valor de ${valorFmt} (${valorExt}) na conta da San Marino Veículos Ltda no banco ${banco}, AGÊNCIA: ${agencia} CONTA CORRENTE: ${conta} em ${dataDeposito} para pagamento parcial ou total de um veículo chassi/placa.: ${chassiPlaca} que está sendo faturado em nome de ${faturadoNome}, CPF/CNPJ.: ${faturadoCpfCnpj}.`;

      y = drawJustifiedParagraph(doc, texto, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += 18;

      y = addAssinaturaSimples(doc, y, 'Assinatura');

      // usa chassi/placa no nome do arquivo (se informado)
      const placaParaNome = dados.chassiPlaca || '';
      doc.save(buildFilename('DECLARACAO_DEPOSITO_TERCEIROS', placaParaNome, nomeCompleto));
      showToast('PDF da Declaração de Depósito para Terceiros gerado com sucesso!', 'success');
    }

    function gerarInstrumentoResponsabilidade() {
      const dados = obterDadosInstrumento();

      if (!dados.nomeCompleto || !dados.cpfCnpj || !dados.chassi || !dados.modelo) {
        showToast('Para o Instrumento de Responsabilidade, preencha pelo menos: nome, CPF/CNPJ, modelo e chassi do veículo.', 'error');
        return;
      }

      if (dados.chassi && dados.chassi.length !== 17) {
        showToast('O campo Chassi deve ter exatamente 17 caracteres.', 'error');
        return;
      }

      const doc = createDocA4();
      const x = PDF_LAYOUT.marginLeft;
      const w = contentWidth();

      let { nomeCompleto, cpfCnpj, cidade, modelo, chassi, dataEntrega, horaEntrega, placa } = dados;

      let y = addTitle(doc, 'Instrumento Particular de Responsabilidade', 'Civil e Criminal por Entrega de Veículo');

      const dataTxt = (dataEntrega && dataEntrega.includes('/')) ? dataEntrega : (dataEntrega ? dataEntrega : '____________________');
      const horaTxt = (horaEntrega && horaEntrega.includes(':')) ? horaEntrega : (horaEntrega ? horaEntrega : '____________');

      const p1 = `Declaramos que o veículo ${upperOr(modelo, '')}, chassi ${upperOr(chassi, '')}, de propriedade de ${upperOr(nomeCompleto, '')}, CPF/CNPJ ${cpfCnpj || ''}, foi entregue a este estabelecimento em ${dataTxt}, às ${horaTxt}, ficando a San Marino Veículos Ltda. responsável civil e criminalmente por este veículo a contar desta data.`;
      y = drawJustifiedParagraph(doc, p1, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += 18;

      // Adiciona a linha com cidade e espaços para data.
      y = addLocalDataLinha(doc, y, cidade);
      // Aumenta o espaçamento antes das assinaturas para que fiquem mais abaixo na folha.
      y += 15;
      // Desenha as duas linhas de assinatura (cliente e concessionária).
      y = addAssinaturasDuplas(doc, y, 'Assinatura do cliente', 'Assinatura da concessionária');

      doc.save(buildFilename('RESPONSABILIDADE_ENTREGA', placa, nomeCompleto));
      showToast('PDF do Instrumento de Responsabilidade gerado com sucesso!', 'success');
    }

    function gerarTermoQuitacaoTerceiro() {
      const dados = obterDadosQuitacao();

      if (!dados.nomeCompleto || !dados.cpfCnpj || !dados.modelo || !dados.placa || !dados.chassi) {
        showToast('Para o Termo de Quitação, preencha pelo menos: dados do cliente (nome/CPF) e do veículo entregue (modelo/placa/chassi).', 'error');
        return;
      }

      if (dados.chassi && dados.chassi.length !== 17) {
        showToast('O campo Chassi deve ter exatamente 17 caracteres.', 'error');
        return;
      }

      if (dados.veiculoAdquiridoChassi && dados.veiculoAdquiridoChassi.length !== 17) {
        showToast('O campo Chassi do veículo adquirido deve ter exatamente 17 caracteres.', 'error');
        return;
      }

      const doc = createDocA4();
      const x = PDF_LAYOUT.marginLeft;
      const w = contentWidth();

      let {
        nomeCompleto, cpfCnpj, cidade,
        modelo, anoModelo, placa, chassi, cor,
        cedenteNome, cedenteCpfCnpj, cedenteEndereco, cedenteNumero,
        veiculoAdquiridoModelo, veiculoAdquiridoAnoModelo, veiculoAdquiridoCor, veiculoAdquiridoChassi,
        contratoNumero, valorQuitacao
      } = dados;

      anoModelo = formatarAnoModelo(anoModelo);
      veiculoAdquiridoAnoModelo = formatarAnoModelo(veiculoAdquiridoAnoModelo);

      const cedNome = cedenteNome ? cedenteNome : '_______________________________________________';
      const cedCpf = cedenteCpfCnpj ? cedenteCpfCnpj : '___________________________';
      const cedEnd = cedenteEndereco ? cedenteEndereco : '______________________________________';
      const cedNum = cedenteNumero ? cedenteNumero : '__________';

      const vEntModelo = modelo ? modelo : '______________________________';
      const vEntAno = anoModelo ? anoModelo : '_________';
      const vEntPlaca = placa ? placa.toUpperCase() : '______';
      const vEntChassi = chassi ? chassi.toUpperCase() : '______________________________';
      const vEntCor = cor ? cor.toUpperCase() : '__________________';

      const vAdqModelo = veiculoAdquiridoModelo ? veiculoAdquiridoModelo : '______________________________';
      const vAdqAno = veiculoAdquiridoAnoModelo ? veiculoAdquiridoAnoModelo : '_________';
      const vAdqCor = veiculoAdquiridoCor ? veiculoAdquiridoCor.toUpperCase() : '________';
      const vAdqChassi = veiculoAdquiridoChassi ? veiculoAdquiridoChassi.toUpperCase() : '____________________________';
      const cNum = contratoNumero ? contratoNumero : '___________';

      const nValor = parseCurrencyToNumberBR(valorQuitacao);
      const valQuit = Number.isFinite(nValor) ? formatBRL(nValor) : '________________';

      const anuNome = nomeCompleto ? nomeCompleto : '_______________________________________________';
      const anuCpf = cpfCnpj ? cpfCnpj : '_____________________';
      const anuCidade = cidade ? cidade : '_______';

      let y = addTitle(
        doc,
        'Termo de Quitação',
        'Instrumento particular de quitação de entrega de veículo como parte de pagamento em negócio de terceiros'
      );

      const texto = `Eu, ${cedNome}, CPF/CNPJ ${cedCpf}, residente e domiciliado na Rua ${cedEnd}, nº ${cedNum}, declaro que o veículo ${vEntModelo}, ano/modelo ${vEntAno}, placa ${vEntPlaca}, chassi ${vEntChassi}, cor ${vEntCor}, está livre e desembaraçado de qualquer ônus e através deste instrumento, dou quitação total do pagamento pelo valor de ${valQuit}, que serve como entrada para aquisição do automóvel ${vAdqModelo}, ano/modelo ${vAdqAno}, cor ${vAdqCor}, chassi ${vAdqChassi}, contrato nº ${cNum}, feito na San Marino Veículos Ltda., em nome de ${anuNome}, CPF/CNPJ ${anuCpf}, residente e domiciliado em ${anuCidade}. Assim, declaro não ter mais nada a reconsiderar ou exigir na presente transação.`;

      y = drawJustifiedParagraph(doc, texto, x, y, w, PDF_LAYOUT.firstLineIndent);
      y += 16;

      y = ensureSpace(doc, y, 18);
      doc.text('Porto Alegre, ______ de ____________________ de ________.', PDF_LAYOUT.pageWidth / 2, y, { align: 'center' });
      y += 18;

      y = addAssinaturasDuplas(doc, y, '(Cedente do veículo)', '(Anuente – cliente conforme o Contrato)');

      y = ensureSpace(doc, y, 22);
      doc.setFontSize(10);
      doc.text('Nome: ____________________________', PDF_LAYOUT.marginLeft, y);
      doc.text('Nome: ____________________________', PDF_LAYOUT.pageWidth / 2 + 5, y);
      y += 7;
      doc.text('CPF: _____________________________', PDF_LAYOUT.marginLeft, y);
      doc.text('CPF: _____________________________', PDF_LAYOUT.pageWidth / 2 + 5, y);
      y += 14;

      // Espaçamento extra entre as assinaturas e a seção de testemunhas.
      y += 15;

      y = ensureSpace(doc, y, 26);
      doc.setFontSize(11);
      doc.text('Testemunhas:', PDF_LAYOUT.marginLeft, y);
      y += 9;
      doc.text('1) _______________________________', PDF_LAYOUT.marginLeft, y);
      y += 7;
      doc.text('2) _______________________________', PDF_LAYOUT.marginLeft, y);

      doc.save(buildFilename('TERMO_QUITACAO_TERCEIRO', placa, nomeCompleto));
      showToast('PDF do Termo de Quitação gerado com sucesso!', 'success');
    }

    /* =========================
       ORÇAMENTO DETRAN - Gerar PDF
       ========================= */
    async function gerarOrcamentoDetran() {
      const orcCard = document.getElementById('printable-orcamento');

      if (!orcCard) {
        showToast('Erro ao localizar o orçamento.', 'error');
        return;
      }

      try {
        showToast('Gerando PDF do orçamento...', 'info');

        // Importar html2canvas dinamicamente
        if (typeof html2canvas === 'undefined') {
          const script = document.createElement('script');
          script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
          document.head.appendChild(script);
          await new Promise(resolve => script.onload = resolve);
        }

        // Capturar o elemento como imagem
        const canvas = await html2canvas(orcCard, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: '#ffffff'
        });

        // Criar PDF
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');

        const imgData = canvas.toDataURL('image/png');
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();

        // Calcular dimensões mantendo proporção
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);

        const imgScaledWidth = imgWidth * ratio;
        const imgScaledHeight = imgHeight * ratio;

        // Centralizar na página
        const x = (pdfWidth - imgScaledWidth) / 2;
        const y = (pdfHeight - imgScaledHeight) / 2;

        pdf.addImage(imgData, 'PNG', x, y, imgScaledWidth, imgScaledHeight);

        // Obter dados para o nome do arquivo
        const proprietario = document.getElementById('orc_proprietario')?.value || 'CLIENTE';
        const placa = document.getElementById('orc_placa')?.value || '';

        pdf.save(buildFilename('ORCAMENTO_DETRAN', placa, proprietario));
        showToast('PDF do Orçamento Detran gerado com sucesso!', 'success');

      } catch (error) {
        console.error('Erro ao gerar PDF:', error);
        showToast('Erro ao gerar PDF. Tente novamente.', 'error');
      }
    }

    /* =========================
       Inicialização
       ========================= */
    window.addEventListener('DOMContentLoaded', () => {

      // Forçar maiúsculas em todos os campos de input
      document.body.addEventListener('input', function (e) {
        // Verifica se é input ou textarea
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
          // Tenta aplicar uppercase
          const start = e.target.selectionStart;
          const end = e.target.selectionEnd;
          const original = e.target.value;
          const upper = original.toUpperCase();

          if (original !== upper) {
            e.target.value = upper;
            // Restaura cursor se suportado
            try {
              e.target.setSelectionRange(start, end);
            } catch (err) {
              // Alguns tipos de input nâo suportam selection (ex: number, email em alguns browsers), ignora
            }
          }
        }
      });

      // Ocultar seções de dados do cliente individuais que agora são globais
      const labelsToHide = ['Dados do Cliente', 'Dados do Cliente (Anuente)'];
      document.querySelectorAll('.section-title').forEach(el => {
        if (labelsToHide.includes(el.textContent.trim())) {
          el.style.display = 'none';
          if (el.nextElementSibling && el.nextElementSibling.classList.contains('form-grid')) {
            el.nextElementSibling.style.display = 'none';
          }
        }
      });

      applyDateMask(document.getElementById('inst_dataEntrega'));
      applyTimeMask(document.getElementById('inst_horaEntrega'));
      attachCurrencyBehavior(document.getElementById('quit_valorQuitacao'));
      applyDateMask(document.getElementById('dep_dataDeposito'));
      attachCurrencyBehavior(document.getElementById('dep_valor'));

      // Aplicar comportamento de moeda às células editáveis do orçamento
      document.querySelectorAll('.orc-price[contenteditable="true"]').forEach(cell => {
        attachCurrencyBehavior(cell);
      });
    });


    /* =========================
       Inicialização de máscaras
       ========================= */
    document.addEventListener('DOMContentLoaded', () => {
      // Datas/Horas já existentes
      applyDateMask(document.getElementById('inst_dataEntrega'));
      applyTimeMask(document.getElementById('inst_horaEntrega'));
      applyDateMask(document.getElementById('dep_dataDeposito'));

      // Ano/Modelo com barra automática
      applyAnoModeloMask(document.getElementById('acordo_anoModelo'));
      applyAnoModeloMask(document.getElementById('rec_anoModelo'));
      applyAnoModeloMask(document.getElementById('quit_anoModelo'));
      applyAnoModeloMask(document.getElementById('quit_veiculoAdquiridoAnoModelo'));
      applyAnoModeloMask(document.getElementById('dep_ano'));
      applyAnoModeloMask(document.getElementById('orc_anoModeloCor'));

      // Iniciar Orçamento
      setOrcamentoDate();
      updateOrcamentoTotal();
    });

    /* =========================
       Funções Orçamento Detran
       ========================= */
    function setOrcamentoDate() {
      const el = document.getElementById('orc_dataRecibo');
      if (!el) return;
      const today = new Date();
      const d = String(today.getDate()).padStart(2, '0');
      const m = String(today.getMonth() + 1).padStart(2, '0');
      const y = today.getFullYear();
      el.value = `${d}/${m}/${y}`;
    }

    function updateOrcamentoTotal() {
      const rows = document.querySelectorAll('#orc-body tr');
      let total = 0;
      rows.forEach(row => {
        const checkbox = row.querySelector('.orc-check');
        const priceCell = row.querySelector('.orc-price');
        // Pula a linha de desconto no loop inicial de soma (ela será subtraída depois)
        if (priceCell && priceCell.id === 'orc_desconto') return;

        if (!checkbox || checkbox.checked) {
          total += parseCurrencyToNumberBR(priceCell.innerText || priceCell.value || '0');
        }
      });

      // Subtrai o desconto
      const descontoEl = document.getElementById('orc_desconto');
      if (descontoEl) {
        const valorDesconto = parseCurrencyToNumberBR(descontoEl.innerText || descontoEl.value || '0');
        if (Number.isFinite(valorDesconto)) {
          total -= valorDesconto;
        }
      }

      const totalEl = document.getElementById('orc-total');
      if (totalEl) totalEl.innerText = formatBRL(total);
    }

    /* =========================
       CALCULADORA DE JUROS (Cartão) - Inicialização
       ========================= */
    document.addEventListener('DOMContentLoaded', () => {
      const calcBtnBanri = document.getElementById("calc_btnBanri");
      const calcBtnRede = document.getElementById("calc_btnRede");
      const calcEmptyState = document.getElementById("calc_emptyState");
      const calcContent = document.getElementById("calc_content");
      const calcTbody = document.getElementById("calc_tbody");
      const calcBaseInput = document.getElementById("calc_baseValue");
      const calcBtnLimpar = document.getElementById("calc_btnLimpar");

      // Se o card não existir (caso alguém remova), sai sem erro
      if (!calcBtnBanri || !calcBtnRede || !calcEmptyState || !calcContent || !calcTbody || !calcBaseInput || !calcBtnLimpar) return;

      // Dados (iguais aos da planilha)
      const CALC_BANRI = [
        { label: "Débito", n: 1, taxa: 1.50, fator: 0.985 },
        { label: "1x / 30 dias", n: 1, taxa: 5.80, fator: 0.942 },
        { label: "2x", n: 2, taxa: 7.30, fator: 0.927 },
        { label: "3x", n: 3, taxa: 8.80, fator: 0.912 },
        { label: "4x", n: 4, taxa: 10.30, fator: 0.897 },
      ];

      const CALC_REDE = [
        { label: "1x", n: 1, taxa: 1.55, fator: 0.985 },
        { label: "2x", n: 2, taxa: 3.05, fator: 0.970 },
        { label: "3x", n: 3, taxa: 4.50, fator: 0.954 },
        { label: "4x", n: 4, taxa: 5.38, fator: 0.946 },
        { label: "5x", n: 5, taxa: 6.15, fator: 0.939 },
        { label: "6x", n: 6, taxa: 6.93, fator: 0.931 },
        { label: "7x", n: 7, taxa: 7.90, fator: 0.921 },
        { label: "8x", n: 8, taxa: 8.68, fator: 0.913 },
        { label: "9x", n: 9, taxa: 9.45, fator: 0.906 },
        { label: "10x", n: 10, taxa: 10.23, fator: 0.898 },
      ];

      // Helpers
      const calc_brl = new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" });
      const calc_pct = (v) => (v / 100).toLocaleString("pt-BR", { style: "percent", minimumFractionDigits: 2, maximumFractionDigits: 2 });
      const calc_fator3 = (v) => v.toLocaleString("pt-BR", { minimumFractionDigits: 3, maximumFractionDigits: 3 });

      function calc_parseBRL(str) {
        if (!str) return 0;
        const s = String(str).trim()
          .replace(/\s/g, "")
          .replace(/\./g, "")
          .replace(",", ".")
          .replace(/[^\d.]/g, "");
        const val = Number(s);
        return Number.isFinite(val) ? val : 0;
      }

      function calc_formatBRLInput(el) {
        const v = calc_parseBRL(el.value);
        if (!v) {
          el.value = "";
          return 0;
        }
        el.value = v.toLocaleString("pt-BR", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        return v;
      }

      function calc_valorCobrar(base, fator) {
        if (!base || !fator) return 0;
        return base / fator;
      }

      function calc_parcela(total, n) {
        if (!total || !n) return 0;
        return total / n;
      }

      let calcModo = null; // "BANRI" ou "REDE"

      function calc_currentData() {
        return calcModo === "BANRI" ? CALC_BANRI : (calcModo === "REDE" ? CALC_REDE : []);
      }

      function calc_render() {
        const base = calc_parseBRL(calcBaseInput.value);
        const data = calc_currentData();

        if (!calcModo) {
          calcTbody.innerHTML = "";
          return;
        }

        calcTbody.innerHTML = data.map(row => {
          const total = base ? calc_valorCobrar(base, row.fator) : 0;
          const parc = base ? calc_parcela(total, row.n) : 0;

          const totalTxt = base ? calc_brl.format(total) : "—";
          const parcTxt = base ? calc_brl.format(parc) : "—";

          return `
            <tr>
              <td>${row.label}</td>
              <td class="center calc-muted">${calc_pct(row.taxa)}</td>
              <td class="center calc-muted">${calc_fator3(row.fator)}</td>
              <td class="center"><span class="calc-money">${totalTxt}</span></td>
              <td class="center calc-highlight calc-sep">${row.n}x</td>
              <td class="center calc-highlight"><span class="calc-money">${parcTxt}</span></td>
            </tr>
          `;
        }).join("");
      }

      function calc_setModo(next) {
        calcModo = next;

        calcBtnBanri.classList.toggle("active", calcModo === "BANRI");
        calcBtnRede.classList.toggle("active", calcModo === "REDE");

        calcEmptyState.classList.toggle("hidden", !!calcModo);
        calcContent.classList.toggle("hidden", !calcModo);

        calc_render();
      }

      // Eventos
      calcBtnBanri.addEventListener("click", () => calc_setModo("BANRI"));
      calcBtnRede.addEventListener("click", () => calc_setModo("REDE"));

      calcBaseInput.addEventListener("input", () => calc_render());
      calcBaseInput.addEventListener("blur", () => { calc_formatBRLInput(calcBaseInput); calc_render(); });

      calcBtnLimpar.addEventListener("click", () => {
        calcBaseInput.value = "";
        calc_render();
        calcBaseInput.focus();
      });

      // Inicial: sem escolha
      calc_setModo(null);

      // Inicializar na seção do Gerador de Documentos
      alternarSecao('gerador');

      // Contador de Visitas
      fetch('https://api.counterapi.dev/v1/albertomateus-sanmarino/visitas/up')
        .then(res => res.json())
        .then(data => {
          const el = document.getElementById('visitas-count');
          if (el && data.count) el.innerText = data.count.toLocaleString('pt-BR');
        })
        .catch(() => {
          const el = document.getElementById('visitas-count');
          if (el) el.innerText = '0';
        });
    });
  </script>
</body>

</html>